import{a as Gt}from"./chunk-AUVTR7ER.js";import"./chunk-GGQ7LRWG.js";import"./chunk-W4AHS3DZ.js";import{b as Yt}from"./chunk-SOD3ETRX.js";import{a as Ne,b as He,c as qt,d as Jt,e as Kt,f as Xt,g as Le}from"./chunk-YZHQBPKS.js";import{b as ge,d as pe,f as he}from"./chunk-GURXHOCJ.js";import{a as Zt,b as en,c as tn,d as nn,e as rn,f as on,g as an,h as sn,i as ln,j as cn,k as dn}from"./chunk-66EBL4AI.js";import{b as zt,c as Vt}from"./chunk-BHUWSNYL.js";import{b as ze,c as Ve}from"./chunk-5QG37IKZ.js";import{c as $t,e as Te,g as Nt,h as Ht,k as Ee,l as $e,m as Ft,n as jt}from"./chunk-4QNLZ27S.js";import"./chunk-F5X5MWHG.js";import{a as Bt,b as Ut}from"./chunk-H6HE4MHR.js";import"./chunk-QI4NFHPB.js";import{a as Qt}from"./chunk-UMVVOU4F.js";import"./chunk-3XTS6IX6.js";import{a as Fe,b as je,c as Be,e as Ue,f as We,g as de}from"./chunk-VE33HBPU.js";import{a as qe,b as Je}from"./chunk-RKVGNEAU.js";import{a as ue,b as me}from"./chunk-YYCZXRKQ.js";import"./chunk-YG2AVUDB.js";import{$a as le,Da as ke,Ha as Oe,La as Ae,Ua as Lt,Wa as Re,Ya as ae,Za as se,_a as Wt,ab as ce,g as De,h as Ie,k as At,n as oe,u as _t,z as Rt}from"./chunk-F6AVZLPP.js";import{Ac as Pe,Dc as Tt,Fc as Et,H as xe,Hc as kt,Ic as Ot,Mb as wt,Sb as C,Tb as o,Ub as s,Vb as A,Wb as H,Xb as L,Zb as Me,a as M,b as Q,ba as X,c as Z,cb as we,cc as x,dc as S,fb as a,h,ha as yt,hc as Mt,ic as Pt,jc as Dt,kb as O,la as xt,n as ee,nc as It,o as ft,oc as U,pc as N,qc as k,rb as te,rc as c,sa as j,sc as g,ta as B,tc as f,xb as P,xc as ne,yc as ie,zc as re}from"./chunk-PBCT4LDD.js";var Ke=class i{constructor(e,t,n){this.dialogRef=e;this.data=t;this.translationService=n}onClose(){this.dialogRef.close()}onContactCustomer(){this.data.onContactCustomer&&this.data.onContactCustomer(this.data.delivery),this.dialogRef.close()}formatCurrency(e){return new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SYP",minimumFractionDigits:0}).format(e)}getTimeDifferenceClass(e){return e&&e.includes("+")?"time-positive":e&&e.includes("-")?"time-negative":"time-neutral"}getTimeDifferenceIcon(e){return e&&e.includes("+")?"schedule":e&&e.includes("-")?"warning":"schedule"}getCustomerStatusClass(e){switch(e){case"\u0646\u0634\u064A\u0637":return"status-active";default:return"status-normal"}}getCustomerStatusIcon(e){switch(e){case"\u0646\u0634\u064A\u0637":return"person";default:return"person_outline"}}getOrderStatusClass(e){switch(e){case(this.translationService.translate("delivering")||"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0648\u0635\u064A\u0644"):return"status-active";case(this.translationService.translate("out_for_delivery")||"\u0641\u064A \u0627\u0644\u0637\u0631\u064A\u0642"):return"status-normal";default:return"status-normal"}}getOrderStatusIcon(e){switch(e){case(this.translationService.translate("delivering")||"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0648\u0635\u064A\u0644"):return"local_shipping";case(this.translationService.translate("out_for_delivery")||"\u0641\u064A \u0627\u0644\u0637\u0631\u064A\u0642"):return"directions_car";default:return"pending"}}static \u0275fac=function(t){return new(t||i)(O(Ne),O(He),O(ce))};static \u0275cmp=te({type:i,selectors:[["app-delivery-details-dialog"]],decls:107,vars:38,consts:[[1,"delivery-details-dialog"],[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",1,"close-btn",3,"click"],[1,"dialog-content"],[1,"delivery-info-grid"],[1,"info-card"],["mat-card-avatar",""],[1,"info-row"],[1,"label"],[1,"value","order-id"],[1,"value"],[1,"value","amount"],[1,"value","phone"],[1,"dialog-actions"],["mat-button","",1,"cancel-btn",3,"click"],["mat-raised-button","","color","primary",1,"contact-btn",3,"click"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2)(3,"mat-icon"),c(4,"local_shipping"),s(),c(5),s(),o(6,"button",3),x("click",function(){return n.onClose()}),o(7,"mat-icon"),c(8,"close"),s()()(),o(9,"mat-dialog-content",4)(10,"div",5)(11,"mat-card",6)(12,"mat-card-header")(13,"mat-icon",7),c(14,"receipt"),s(),o(15,"mat-card-title"),c(16),s()(),o(17,"mat-card-content")(18,"div",8)(19,"span",9),c(20),s(),o(21,"span",10),c(22),s()(),o(23,"div",8)(24,"span",9),c(25),s(),o(26,"span",11),c(27),s()(),o(28,"div",8)(29,"span",9),c(30),s(),o(31,"span",12),c(32),s()(),o(33,"div",8)(34,"span",9),c(35),s(),o(36,"mat-chip-set")(37,"mat-chip")(38,"mat-icon"),c(39),s(),c(40),s()()()()(),o(41,"mat-card",6)(42,"mat-card-header")(43,"mat-icon",7),c(44,"person"),s(),o(45,"mat-card-title"),c(46),s()(),o(47,"mat-card-content")(48,"div",8)(49,"span",9),c(50),s(),o(51,"span",11),c(52),s()(),o(53,"div",8)(54,"span",9),c(55),s(),o(56,"span",13),c(57),s()(),o(58,"div",8)(59,"span",9),c(60),s(),o(61,"mat-chip-set")(62,"mat-chip")(63,"mat-icon"),c(64),s(),c(65),s()()()()(),o(66,"mat-card",6)(67,"mat-card-header")(68,"mat-icon",7),c(69,"store"),s(),o(70,"mat-card-title"),c(71),s()(),o(72,"mat-card-content")(73,"div",8)(74,"span",9),c(75),s(),o(76,"span",11),c(77),s()(),o(78,"div",8)(79,"span",9),c(80),s(),o(81,"span",11),c(82),s()()()(),o(83,"mat-card",6)(84,"mat-card-header")(85,"mat-icon",7),c(86,"schedule"),s(),o(87,"mat-card-title"),c(88),s()(),o(89,"mat-card-content")(90,"div",8)(91,"span",9),c(92),s(),o(93,"mat-chip-set")(94,"mat-chip")(95,"mat-icon"),c(96),s(),c(97),s()()()()()()(),o(98,"mat-dialog-actions",14)(99,"button",15),x("click",function(){return n.onClose()}),o(100,"mat-icon"),c(101,"close"),s(),c(102),s(),o(103,"button",16),x("click",function(){return n.onContactCustomer()}),o(104,"mat-icon"),c(105,"chat"),s(),c(106),s()()()),t&2&&(N("rtl",n.translationService.isRTL()),a(5),f(" ",n.translationService.translate("deliveryDetails")||"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062A\u0648\u0635\u064A\u0644"," "),a(11),g(n.translationService.translate("orderInformation")||"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0644\u0628"),a(4),f("",n.translationService.translate("orderId")||"\u0631\u0642\u0645 \u0627\u0644\u0637\u0644\u0628",":"),a(2),f("#",n.data.delivery.id),a(3),f("",n.translationService.translate("orderTime")||"\u0648\u0642\u062A \u0627\u0644\u0637\u0644\u0628",":"),a(2),g(n.data.delivery.orderTime),a(3),f("",n.translationService.translate("amount")||"\u0627\u0644\u0645\u0628\u0644\u063A",":"),a(2),g(n.formatCurrency(n.data.delivery.amount)),a(3),f("",n.translationService.translate("orderStatus")||"\u062D\u0627\u0644\u0629 \u0627\u0644\u0637\u0644\u0628",":"),a(2),k(n.getOrderStatusClass(n.data.delivery.orderStatus||"")),a(2),g(n.getOrderStatusIcon(n.data.delivery.orderStatus||"")),a(),f(" ",n.data.delivery.orderStatus," "),a(6),g(n.translationService.translate("customerInformation")||"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0639\u0645\u064A\u0644"),a(4),f("",n.translationService.translate("customerName")||"\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u064A\u0644",":"),a(2),g(n.data.delivery.customerName||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(3),f("",n.translationService.translate("phoneNumber")||"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641",":"),a(2),g(n.data.delivery.customerPhoneNumber||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(3),f("",n.translationService.translate("customerStatus")||"\u062D\u0627\u0644\u0629 \u0627\u0644\u0639\u0645\u064A\u0644",":"),a(2),k(n.getCustomerStatusClass(n.data.delivery.customerStatus||"")),a(2),g(n.getCustomerStatusIcon(n.data.delivery.customerStatus||"")),a(),f(" ",n.data.delivery.customerStatus," "),a(6),g(n.translationService.translate("storeInformation")||"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0645\u062A\u062C\u0631"),a(4),f("",n.translationService.translate("storeName")||"\u0627\u0633\u0645 \u0627\u0644\u0645\u062A\u062C\u0631",":"),a(2),g(n.data.delivery.storeName||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(3),f("",n.translationService.translate("city")||"\u0627\u0644\u0645\u062F\u064A\u0646\u0629",":"),a(2),g(n.data.delivery.city||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(6),g(n.translationService.translate("deliveryInformation")||"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u062A\u0648\u0635\u064A\u0644"),a(4),f("",n.translationService.translate("deliveryTimeDifference")||"\u0641\u0627\u0631\u0642 \u0632\u0645\u0646 \u0627\u0644\u062A\u0648\u0635\u064A\u0644",":"),a(2),k(n.getTimeDifferenceClass(n.data.delivery.deliveryTimeDifference||"")),a(2),g(n.getTimeDifferenceIcon(n.data.delivery.deliveryTimeDifference||"")),a(),f(" ",n.data.delivery.deliveryTimeDifference," "),a(5),f(" ",n.translationService.translate("close")||"\u0625\u063A\u0644\u0627\u0642"," "),a(4),f(" ",n.translationService.translate("startChat")||"\u0628\u062F\u0621 \u0645\u062D\u0627\u062F\u062B\u0629"," "))},dependencies:[oe,Le,Jt,Xt,Kt,le,se,ae,me,ue,de,Fe,We,Be,Ue,je,Yt,he,ge,pe],styles:[".delivery-details-dialog[_ngcontent-%COMP%]{min-width:600px;max-width:800px;max-height:90vh;overflow-y:auto}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px 0;border-bottom:1px solid #e0e0e0;margin-bottom:20px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:12px;color:#2c3e50;font-size:1.5rem;font-weight:600}.close-btn[_ngcontent-%COMP%]{color:#7f8c8d}.dialog-content[_ngcontent-%COMP%]{padding:0 24px;max-height:60vh;overflow-y:auto}.delivery-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-bottom:20px}.info-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:12px 12px 0 0;margin:-16px -16px 16px;padding:16px}.info-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#2c3e50;display:flex;align-items:center;gap:8px}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f0f0f0}.info-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.label[_ngcontent-%COMP%]{font-weight:600;color:#7f8c8d;min-width:120px}.value[_ngcontent-%COMP%]{color:#2c3e50;font-weight:500;text-align:right}.order-id[_ngcontent-%COMP%]{color:#667eea;font-weight:700}.amount[_ngcontent-%COMP%]{color:#27ae60;font-weight:700}.phone[_ngcontent-%COMP%]{color:#3498db;font-weight:600}.dialog-actions[_ngcontent-%COMP%]{padding:20px 24px;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end;gap:12px}.cancel-btn[_ngcontent-%COMP%]{color:#7f8c8d}.contact-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none}.contact-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#5a6fd8,#6a4190)}.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.status-normal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3);color:#2c3e50}.time-positive[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.time-negative[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140);color:#fff}.time-neutral[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffecd2,#fcb69f);color:#2c3e50}.rtl[_ngcontent-%COMP%]{direction:rtl}.rtl[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{flex-direction:row-reverse}.rtl[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-align:left}@media (max-width: 768px){.delivery-details-dialog[_ngcontent-%COMP%]{min-width:90vw;max-width:95vw}.delivery-info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3rem}.info-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.label[_ngcontent-%COMP%]{min-width:unset}}"]})};var R=class extends Error{constructor(e,t){let n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}},J=class extends Error{constructor(e="A timeout occurred."){let t=new.target.prototype;super(e),this.__proto__=t}},E=class extends Error{constructor(e="An abort occurred."){let t=new.target.prototype;super(e),this.__proto__=t}},Xe=class extends Error{constructor(e,t){let n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n}},Ye=class extends Error{constructor(e,t){let n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n}},Ge=class extends Error{constructor(e,t){let n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n}},Ce=class extends Error{constructor(e){let t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}},Qe=class extends Error{constructor(e,t){let n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}};var fe=class{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}},W=class{get(e,t){return this.send(Q(M({},t),{method:"GET",url:e}))}post(e,t){return this.send(Q(M({},t),{method:"POST",url:e}))}delete(e,t){return this.send(Q(M({},t),{method:"DELETE",url:e}))}getCookieString(e){return""}};var d=function(i){return i[i.Trace=0]="Trace",i[i.Debug=1]="Debug",i[i.Information=2]="Information",i[i.Warning=3]="Warning",i[i.Error=4]="Error",i[i.Critical=5]="Critical",i[i.None=6]="None",i}(d||{});var z=class{constructor(){}log(e,t){}};z.instance=new z;var _n="9.0.6";var y=class{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}},w=class i{static get isBrowser(){return!i.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!i.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!i.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}};function K(i,e){let t="";return F(i)?(t=`Binary data of length ${i.byteLength}`,e&&(t+=`. Content: '${Mn(i)}'`)):typeof i=="string"&&(t=`String data of length ${i.length}`,e&&(t+=`. Content: '${i}'`)),t}function Mn(i){let e=new Uint8Array(i),t="";return e.forEach(n=>{let r=n<16?"0":"";t+=`0x${r}${n.toString(16)} `}),t.substr(0,t.length-1)}function F(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function et(i,e,t,n,r,l){return h(this,null,function*(){let u={},[m,p]=V();u[m]=p,i.log(d.Trace,`(${e} transport) sending data. ${K(r,l.logMessageContent)}.`);let v=F(r)?"arraybuffer":"text",b=yield t.post(n,{content:r,headers:M(M({},u),l.headers),responseType:v,timeout:l.timeout,withCredentials:l.withCredentials});i.log(d.Trace,`(${e} transport) request complete. Response status: ${b.statusCode}.`)})}function vn(i){return i===void 0?new Y(d.Information):i===null?z.instance:i.log!==void 0?i:new Y(i)}var Ze=class{constructor(e,t){this._subject=e,this._observer=t}dispose(){let e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}},Y=class{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){let n=`[${new Date().toISOString()}] ${d[e]}: ${t}`;switch(e){case d.Critical:case d.Error:this.out.error(n);break;case d.Warning:this.out.warn(n);break;case d.Information:this.out.info(n);break;default:this.out.log(n);break}}}};function V(){let i="X-SignalR-User-Agent";return w.isNode&&(i="User-Agent"),[i,Pn(_n,Dn(),Tn(),In())]}function Pn(i,e,t,n){let r="Microsoft SignalR/",l=i.split(".");return r+=`${l[0]}.${l[1]}`,r+=` (${i}; `,e&&e!==""?r+=`${e}; `:r+="Unknown OS; ",r+=`${t}`,n?r+=`; ${n}`:r+="; Unknown Runtime Version",r+=")",r}function Dn(){if(w.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function In(){if(w.isNode)return process.versions.node}function Tn(){return w.isNode?"NodeJS":"Browser"}function tt(i){return i.stack?i.stack:i.message?i.message:`${i}`}function Cn(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}var nt=class extends W{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||w.isNode){let t=typeof __webpack_require__=="function"?__non_webpack_require__:Z;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(Cn());if(typeof AbortController>"u"){let t=typeof __webpack_require__=="function"?__non_webpack_require__:Z;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){return h(this,null,function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new E;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");let t=new this._abortControllerType,n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new E});let r=null;if(e.timeout){let p=e.timeout;r=setTimeout(()=>{t.abort(),this._logger.log(d.Warning,"Timeout from HTTP request."),n=new J},p)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},F(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");let l;try{l=yield this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:M({"X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(p){throw n||(this._logger.log(d.Warning,`Error from HTTP request. ${p}.`),p)}finally{r&&clearTimeout(r),e.abortSignal&&(e.abortSignal.onabort=null)}if(!l.ok){let p=yield bn(l,"text");throw new R(p||l.statusText,l.status)}let m=yield bn(l,e.responseType);return new fe(l.status,l.statusText,m)})}getCookieString(e){let t="";return w.isNode&&this._jar&&this._jar.getCookies(e,(n,r)=>t=r.join("; ")),t}};function bn(i,e){let t;switch(e){case"arraybuffer":t=i.arrayBuffer();break;case"text":t=i.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:t=i.text();break}return t}var it=class extends W{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new E):e.method?e.url?new Promise((t,n)=>{let r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(F(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));let l=e.headers;l&&Object.keys(l).forEach(u=>{r.setRequestHeader(u,l[u])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),n(new E)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new fe(r.status,r.statusText,r.response||r.responseText)):n(new R(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(d.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),n(new R(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(d.Warning,"Timeout from HTTP request."),n(new J)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}};var rt=class extends W{constructor(e){if(super(),typeof fetch<"u"||w.isNode)this._httpClient=new nt(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new it(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new E):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}};var $=class i{static write(e){return`${e}${i.RecordSeparator}`}static parse(e){if(e[e.length-1]!==i.RecordSeparator)throw new Error("Message is incomplete.");let t=e.split(i.RecordSeparator);return t.pop(),t}};$.RecordSeparatorCode=30;$.RecordSeparator=String.fromCharCode($.RecordSeparatorCode);var ot=class{writeHandshakeRequest(e){return $.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(F(e)){let m=new Uint8Array(e),p=m.indexOf($.RecordSeparatorCode);if(p===-1)throw new Error("Message is incomplete.");let v=p+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(m.slice(0,v))),n=m.byteLength>v?m.slice(v).buffer:null}else{let m=e,p=m.indexOf($.RecordSeparator);if(p===-1)throw new Error("Message is incomplete.");let v=p+1;t=m.substring(0,v),n=m.length>v?m.substring(v):null}let r=$.parse(t),l=JSON.parse(r[0]);if(l.type)throw new Error("Expected a handshake response from the server.");return[n,l]}};var _=function(i){return i[i.Invocation=1]="Invocation",i[i.StreamItem=2]="StreamItem",i[i.Completion=3]="Completion",i[i.StreamInvocation=4]="StreamInvocation",i[i.CancelInvocation=5]="CancelInvocation",i[i.Ping=6]="Ping",i[i.Close=7]="Close",i[i.Ack=8]="Ack",i[i.Sequence=9]="Sequence",i}(_||{});var at=class{constructor(){this.observers=[]}next(e){for(let t of this.observers)t.next(e)}error(e){for(let t of this.observers)t.error&&t.error(e)}complete(){for(let e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Ze(this,e)}};var st=class{constructor(e,t,n){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=n}_send(e){return h(this,null,function*(){let t=this._protocol.writeMessage(e),n=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let r=()=>{},l=()=>{};F(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(n=new Promise((u,m)=>{r=u,l=m})),this._messages.push(new Ct(t,this._totalMessageCount,r,l))}try{this._reconnectInProgress||(yield this._connection.send(t))}catch{this._disconnected()}yield n})}_ack(e){let t=-1;for(let n=0;n<this._messages.length;n++){let r=this._messages[n];if(r._id<=e.sequenceId)t=n,F(r._message)?this._bufferedByteCount-=r._message.byteLength:this._bufferedByteCount-=r._message.length,r._resolver();else if(this._bufferedByteCount<this._bufferSize)r._resolver();else break}t!==-1&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type!==_.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;let t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){if(e.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}_resend(){return h(this,null,function*(){let e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;yield this._connection.send(this._protocol.writeMessage({type:_.Sequence,sequenceId:e}));let t=this._messages;for(let n of t)yield this._connection.send(n._message);this._reconnectInProgress=!1})}_dispose(e){e??(e=new Error("Unable to reconnect to server."));for(let t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case _.Invocation:case _.StreamItem:case _.Completion:case _.StreamInvocation:case _.CancelInvocation:return!0;case _.Close:case _.Sequence:case _.Ping:case _.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(()=>h(this,null,function*(){try{this._reconnectInProgress||(yield this._connection.send(this._protocol.writeMessage({type:_.Ack,sequenceId:this._latestReceivedSequenceId})))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0}),1e3))}},Ct=class{constructor(e,t,n,r){this._message=e,this._id=t,this._resolver=n,this._rejector=r}};var En=30*1e3,kn=15*1e3,On=1e5,D=function(i){return i.Disconnected="Disconnected",i.Connecting="Connecting",i.Connected="Connected",i.Disconnecting="Disconnecting",i.Reconnecting="Reconnecting",i}(D||{}),lt=class i{static create(e,t,n,r,l,u,m){return new i(e,t,n,r,l,u,m)}constructor(e,t,n,r,l,u,m){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(d.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},y.isRequired(e,"connection"),y.isRequired(t,"logger"),y.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=l??En,this.keepAliveIntervalInMilliseconds=u??kn,this._statefulReconnectBufferSize=m??On,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new ot,this.connection.onreceive=p=>this._processIncomingData(p),this.connection.onclose=p=>this._connectionClosed(p),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=D.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:_.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==D.Disconnected&&this._connectionState!==D.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){return h(this,null,function*(){if(this._connectionState!==D.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=D.Connecting,this._logger.log(d.Debug,"Starting HubConnection.");try{yield this._startInternal(),w.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=D.Connected,this._connectionStarted=!0,this._logger.log(d.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=D.Disconnected,this._logger.log(d.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}})}_startInternal(){return h(this,null,function*(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;let e=new Promise((t,n)=>{this._handshakeResolver=t,this._handshakeRejecter=n});yield this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);let n={protocol:this._protocol.name,version:t};if(this._logger.log(d.Debug,"Sending handshake request."),yield this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n)),this._logger.log(d.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),yield e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new st(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||(yield this._sendMessage(this._cachedPingMessage))}catch(t){throw this._logger.log(d.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),yield this.connection.stop(t),t}})}stop(){return h(this,null,function*(){let e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),yield this._stopPromise;try{yield e}catch{}})}_stopInternal(e){if(this._connectionState===D.Disconnected)return this._logger.log(d.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===D.Disconnecting)return this._logger.log(d.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;let t=this._connectionState;return this._connectionState=D.Disconnecting,this._logger.log(d.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(d.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===D.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new E("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}_sendCloseMessage(){return h(this,null,function*(){try{yield this._sendWithProtocol(this._createCloseMessage())}catch{}})}stream(e,...t){let[n,r]=this._replaceStreamingParams(t),l=this._createStreamInvocation(e,t,r),u,m=new at;return m.cancelCallback=()=>{let p=this._createCancelInvocation(l.invocationId);return delete this._callbacks[l.invocationId],u.then(()=>this._sendWithProtocol(p))},this._callbacks[l.invocationId]=(p,v)=>{if(v){m.error(v);return}else p&&(p.type===_.Completion?p.error?m.error(new Error(p.error)):m.complete():m.next(p.item))},u=this._sendWithProtocol(l).catch(p=>{m.error(p),delete this._callbacks[l.invocationId]}),this._launchStreams(n,u),m}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){let[n,r]=this._replaceStreamingParams(t),l=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(n,l),l}invoke(e,...t){let[n,r]=this._replaceStreamingParams(t),l=this._createInvocation(e,t,!1,r);return new Promise((m,p)=>{this._callbacks[l.invocationId]=(b,q)=>{if(q){p(q);return}else b&&(b.type===_.Completion?b.error?p(new Error(b.error)):m(b.result):p(new Error(`Unexpected message type: ${b.type}`)))};let v=this._sendWithProtocol(l).catch(b=>{p(b),delete this._callbacks[l.invocationId]});this._launchStreams(n,v)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();let n=this._methods[e];if(n)if(t){let r=n.indexOf(t);r!==-1&&(n.splice(r,1),n.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){let t=this._protocol.parseMessages(e,this._logger);for(let n of t)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(n)))switch(n.type){case _.Invocation:this._invokeClientMethod(n).catch(r=>{this._logger.log(d.Error,`Invoke client method threw error: ${tt(r)}`)});break;case _.StreamItem:case _.Completion:{let r=this._callbacks[n.invocationId];if(r){n.type===_.Completion&&delete this._callbacks[n.invocationId];try{r(n)}catch(l){this._logger.log(d.Error,`Stream callback threw error: ${tt(l)}`)}}break}case _.Ping:break;case _.Close:{this._logger.log(d.Information,"Close message received from server.");let r=n.error?new Error("Server returned an error on close: "+n.error):void 0;n.allowReconnect===!0?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}case _.Ack:this._messageBuffer&&this._messageBuffer._ack(n);break;case _.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(n);break;default:this._logger.log(d.Warning,`Invalid message type: ${n.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){let l="Error parsing handshake response: "+r;this._logger.log(d.Error,l);let u=new Error(l);throw this._handshakeRejecter(u),u}if(t.error){let r="Server returned handshake error: "+t.error;this._logger.log(d.Error,r);let l=new Error(r);throw this._handshakeRejecter(l),l}else this._logger.log(d.Debug,"Server handshake complete.");return this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(()=>h(this,null,function*(){if(this._connectionState===D.Connected)try{yield this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){return h(this,null,function*(){let t=e.target.toLowerCase(),n=this._methods[t];if(!n){this._logger.log(d.Warning,`No client method with the name '${t}' found.`),e.invocationId&&(this._logger.log(d.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),yield this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)));return}let r=n.slice(),l=!!e.invocationId,u,m,p;for(let v of r)try{let b=u;u=yield v.apply(this,e.arguments),l&&u&&b&&(this._logger.log(d.Error,`Multiple results provided for '${t}'. Sending error to server.`),p=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),m=void 0}catch(b){m=b,this._logger.log(d.Error,`A callback for the method '${t}' threw error '${b}'.`)}p?yield this._sendWithProtocol(p):l?(m?p=this._createCompletionMessage(e.invocationId,`${m}`,null):u!==void 0?p=this._createCompletionMessage(e.invocationId,null,u):(this._logger.log(d.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),p=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield this._sendWithProtocol(p)):u&&this._logger.log(d.Error,`Result given for '${t}' method but server is not expecting a result.`)})}_connectionClosed(e){this._logger.log(d.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new E("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===D.Disconnecting?this._completeClose(e):this._connectionState===D.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===D.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=D.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),w.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(d.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){return h(this,null,function*(){let t=Date.now(),n=0,r=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),l=this._getNextRetryDelay(n++,0,r);if(l===null){this._logger.log(d.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=D.Reconnecting,e?this._logger.log(d.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(d.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(u=>u.apply(this,[e]))}catch(u){this._logger.log(d.Error,`An onreconnecting callback called with error '${e}' threw error '${u}'.`)}if(this._connectionState!==D.Reconnecting){this._logger.log(d.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;l!==null;){if(this._logger.log(d.Information,`Reconnect attempt number ${n} will start in ${l} ms.`),yield new Promise(u=>{this._reconnectDelayHandle=setTimeout(u,l)}),this._reconnectDelayHandle=void 0,this._connectionState!==D.Reconnecting){this._logger.log(d.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(yield this._startInternal(),this._connectionState=D.Connected,this._logger.log(d.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(u=>u.apply(this,[this.connection.connectionId]))}catch(u){this._logger.log(d.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${u}'.`)}return}catch(u){if(this._logger.log(d.Information,`Reconnect attempt failed because of error '${u}'.`),this._connectionState!==D.Reconnecting){this._logger.log(d.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===D.Disconnecting&&this._completeClose();return}r=u instanceof Error?u:new Error(u.toString()),l=this._getNextRetryDelay(n++,Date.now()-t,r)}}this._logger.log(d.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()})}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(r){return this._logger.log(d.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){let t=this._callbacks;this._callbacks={},Object.keys(t).forEach(n=>{let r=t[n];try{r(null,e)}catch(l){this._logger.log(d.Error,`Stream 'error' callback called with '${e}' threw error: ${tt(l)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,n,r){if(n)return r.length!==0?{target:e,arguments:t,streamIds:r,type:_.Invocation}:{target:e,arguments:t,type:_.Invocation};{let l=this._invocationId;return this._invocationId++,r.length!==0?{target:e,arguments:t,invocationId:l.toString(),streamIds:r,type:_.Invocation}:{target:e,arguments:t,invocationId:l.toString(),type:_.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(let n in e)e[n].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(n)))},error:r=>{let l;r instanceof Error?l=r.message:r&&r.toString?l=r.toString():l="Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(n,l)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(n,r)))}})}}_replaceStreamingParams(e){let t=[],n=[];for(let r=0;r<e.length;r++){let l=e[r];if(this._isObservable(l)){let u=this._invocationId;this._invocationId++,t[u]=l,n.push(u.toString()),e.splice(r,1)}}return[t,n]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,n){let r=this._invocationId;return this._invocationId++,n.length!==0?{target:e,arguments:t,invocationId:r.toString(),streamIds:n,type:_.StreamInvocation}:{target:e,arguments:t,invocationId:r.toString(),type:_.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:_.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:_.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:_.Completion}:{invocationId:e,result:n,type:_.Completion}}_createCloseMessage(){return{type:_.Close}}};var An=[0,2e3,1e4,3e4,null],be=class{constructor(e){this._retryDelays=e!==void 0?[...e,null]:An}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}};var G=(()=>{class i{}return i.Authorization="Authorization",i.Cookie="Cookie",i})();var ct=class extends W{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){return h(this,null,function*(){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=yield this._accessTokenFactory()),this._setAuthorizationHeader(e);let n=yield this._innerClient.send(e);return t&&n.statusCode===401&&this._accessTokenFactory?(this._accessToken=yield this._accessTokenFactory(),this._setAuthorizationHeader(e),yield this._innerClient.send(e)):n})}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[G.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[G.Authorization]&&delete e.headers[G.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}};var T=function(i){return i[i.None=0]="None",i[i.WebSockets=1]="WebSockets",i[i.ServerSentEvents=2]="ServerSentEvents",i[i.LongPolling=4]="LongPolling",i}(T||{}),I=function(i){return i[i.Text=1]="Text",i[i.Binary=2]="Binary",i}(I||{});var dt=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};var Se=class{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new dt,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null}connect(e,t){return h(this,null,function*(){if(y.isRequired(e,"url"),y.isRequired(t,"transferFormat"),y.isIn(t,I,"transferFormat"),this._url=e,this._logger.log(d.Trace,"(LongPolling transport) Connecting."),t===I.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");let[n,r]=V(),l=M({[n]:r},this._options.headers),u={abortSignal:this._pollAbort.signal,headers:l,timeout:1e5,withCredentials:this._options.withCredentials};t===I.Binary&&(u.responseType="arraybuffer");let m=`${e}&_=${Date.now()}`;this._logger.log(d.Trace,`(LongPolling transport) polling: ${m}.`);let p=yield this._httpClient.get(m,u);p.statusCode!==200?(this._logger.log(d.Error,`(LongPolling transport) Unexpected response code: ${p.statusCode}.`),this._closeError=new R(p.statusText||"",p.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,u)})}_poll(e,t){return h(this,null,function*(){try{for(;this._running;)try{let n=`${e}&_=${Date.now()}`;this._logger.log(d.Trace,`(LongPolling transport) polling: ${n}.`);let r=yield this._httpClient.get(n,t);r.statusCode===204?(this._logger.log(d.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):r.statusCode!==200?(this._logger.log(d.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this._closeError=new R(r.statusText||"",r.statusCode),this._running=!1):r.content?(this._logger.log(d.Trace,`(LongPolling transport) data received. ${K(r.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this._logger.log(d.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(n){this._running?n instanceof J?this._logger.log(d.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=n,this._running=!1):this._logger.log(d.Trace,`(LongPolling transport) Poll errored after shutdown: ${n.message}`)}}finally{this._logger.log(d.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}})}send(e){return h(this,null,function*(){return this._running?et(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))})}stop(){return h(this,null,function*(){this._logger.log(d.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{yield this._receiving,this._logger.log(d.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);let e={},[t,n]=V();e[t]=n;let r={headers:M(M({},e),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials},l;try{yield this._httpClient.delete(this._url,r)}catch(u){l=u}l?l instanceof R&&(l.statusCode===404?this._logger.log(d.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(d.Trace,`(LongPolling transport) Error sending a DELETE request: ${l}`)):this._logger.log(d.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(d.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}})}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(d.Trace,e),this.onclose(this._closeError)}}};var ut=class{constructor(e,t,n,r){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){return h(this,null,function*(){return y.isRequired(e,"url"),y.isRequired(t,"transferFormat"),y.isIn(t,I,"transferFormat"),this._logger.log(d.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((n,r)=>{let l=!1;if(t!==I.Text){r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let u;if(w.isBrowser||w.isWebWorker)u=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{let m=this._httpClient.getCookieString(e),p={};p.Cookie=m;let[v,b]=V();p[v]=b,u=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:M(M({},p),this._options.headers)})}try{u.onmessage=m=>{if(this.onreceive)try{this._logger.log(d.Trace,`(SSE transport) data received. ${K(m.data,this._options.logMessageContent)}.`),this.onreceive(m.data)}catch(p){this._close(p);return}},u.onerror=m=>{l?this._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},u.onopen=()=>{this._logger.log(d.Information,`SSE connected to ${this._url}`),this._eventSource=u,l=!0,n()}}catch(m){r(m);return}})})}send(e){return h(this,null,function*(){return this._eventSource?et(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))})}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}};var mt=class{constructor(e,t,n,r,l,u){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=l,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=u}connect(e,t){return h(this,null,function*(){y.isRequired(e,"url"),y.isRequired(t,"transferFormat"),y.isIn(t,I,"transferFormat"),this._logger.log(d.Trace,"(WebSockets transport) Connecting.");let n;return this._accessTokenFactory&&(n=yield this._accessTokenFactory()),new Promise((r,l)=>{e=e.replace(/^http/,"ws");let u,m=this._httpClient.getCookieString(e),p=!1;if(w.isNode||w.isReactNative){let v={},[b,q]=V();v[b]=q,n&&(v[G.Authorization]=`Bearer ${n}`),m&&(v[G.Cookie]=m),u=new this._webSocketConstructor(e,void 0,{headers:M(M({},v),this._headers)})}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);u||(u=new this._webSocketConstructor(e)),t===I.Binary&&(u.binaryType="arraybuffer"),u.onopen=v=>{this._logger.log(d.Information,`WebSocket connected to ${e}.`),this._webSocket=u,p=!0,r()},u.onerror=v=>{let b=null;typeof ErrorEvent<"u"&&v instanceof ErrorEvent?b=v.error:b="There was an error with the transport",this._logger.log(d.Information,`(WebSockets transport) ${b}.`)},u.onmessage=v=>{if(this._logger.log(d.Trace,`(WebSockets transport) data received. ${K(v.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(v.data)}catch(b){this._close(b);return}},u.onclose=v=>{if(p)this._close(v);else{let b=null;typeof ErrorEvent<"u"&&v instanceof ErrorEvent?b=v.error:b="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",l(new Error(b))}}})})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(d.Trace,`(WebSockets transport) sending data. ${K(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(d.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose())}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}};var Sn=100,gt=class{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,y.isRequired(e,"url"),this._logger=vn(t.logger),this.baseUrl=this._resolveUrl(e),t=t||{},t.logMessageContent=t.logMessageContent===void 0?!1:t.logMessageContent,typeof t.withCredentials=="boolean"||t.withCredentials===void 0)t.withCredentials=t.withCredentials===void 0?!0:t.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.timeout=t.timeout===void 0?100*1e3:t.timeout;let n=null,r=null;if(w.isNode&&typeof Z<"u"){let l=typeof __webpack_require__=="function"?__non_webpack_require__:Z;n=l("ws"),r=l("eventsource")}!w.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:w.isNode&&!t.WebSocket&&n&&(t.WebSocket=n),!w.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:w.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new ct(t.httpClient||new rt(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){return h(this,null,function*(){if(e=e||I.Binary,y.isIn(e,I,"transferFormat"),this._logger.log(d.Debug,`Starting connection with transfer format '${I[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),yield this._startInternalPromise,this._connectionState==="Disconnecting"){let t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(d.Error,t),yield this._stopPromise,Promise.reject(new E(t))}else if(this._connectionState!=="Connected"){let t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(d.Error,t),Promise.reject(new E(t))}this._connectionStarted=!0})}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new bt(this.transport)),this._sendQueue.send(e))}stop(e){return h(this,null,function*(){if(this._connectionState==="Disconnected")return this._logger.log(d.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(d.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),yield this._stopInternal(e),yield this._stopPromise})}_stopInternal(e){return h(this,null,function*(){this._stopError=e;try{yield this._startInternalPromise}catch{}if(this.transport){try{yield this.transport.stop()}catch(t){this._logger.log(d.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(d.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})}_startInternal(e){return h(this,null,function*(){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===T.WebSockets)this.transport=this._constructTransport(T.WebSockets),yield this._startTransport(t,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let n=null,r=0;do{if(n=yield this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new E("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){let l=n.accessToken;this._accessTokenFactory=()=>l,this._httpClient._accessToken=l,this._httpClient._accessTokenFactory=void 0}r++}while(n.url&&r<Sn);if(r===Sn&&n.url)throw new Error("Negotiate redirection limit exceeded.");yield this._createTransport(t,this._options.transport,n,e)}this.transport instanceof Se&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(d.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(n){return this._logger.log(d.Error,"Failed to start the connection: "+n),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(n)}})}_getNegotiationResponse(e){return h(this,null,function*(){let t={},[n,r]=V();t[n]=r;let l=this._resolveNegotiateUrl(e);this._logger.log(d.Debug,`Sending negotiation request: ${l}.`);try{let u=yield this._httpClient.post(l,{content:"",headers:M(M({},t),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(u.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${u.statusCode}'`));let m=JSON.parse(u.content);return(!m.negotiateVersion||m.negotiateVersion<1)&&(m.connectionToken=m.connectionId),m.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Ce("Client didn't negotiate Stateful Reconnect but the server did.")):m}catch(u){let m="Failed to complete negotiation with the server: "+u;return u instanceof R&&u.statusCode===404&&(m=m+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(d.Error,m),Promise.reject(new Ce(m))}})}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}_createTransport(e,t,n,r){return h(this,null,function*(){let l=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t)){this._logger.log(d.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,yield this._startTransport(l,r),this.connectionId=n.connectionId;return}let u=[],m=n.availableTransports||[],p=n;for(let v of m){let b=this._resolveTransportOrError(v,t,r,p?.useStatefulReconnect===!0);if(b instanceof Error)u.push(`${v.transport} failed:`),u.push(b);else if(this._isITransport(b)){if(this.transport=b,!p){try{p=yield this._getNegotiationResponse(e)}catch(q){return Promise.reject(q)}l=this._createConnectUrl(e,p.connectionToken)}try{yield this._startTransport(l,r),this.connectionId=p.connectionId;return}catch(q){if(this._logger.log(d.Error,`Failed to start the transport '${v.transport}': ${q}`),p=void 0,u.push(new Ge(`${v.transport} failed: ${q}`,T[v.transport])),this._connectionState!=="Connecting"){let St="Failed to select transport before stop() was called.";return this._logger.log(d.Debug,St),Promise.reject(new E(St))}}}}return u.length>0?Promise.reject(new Qe(`Unable to connect to the server with any of the available transports. ${u.join(" ")}`,u)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))})}_constructTransport(e){switch(e){case T.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new mt(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case T.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new ut(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case T.LongPolling:return new Se(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=n=>h(this,null,function*(){let r=!1;if(this.features.reconnect)try{this.features.disconnected(),yield this.transport.connect(e,t),yield this.features.resend()}catch{r=!0}else{this._stopConnection(n);return}r&&this._stopConnection(n)}):this.transport.onclose=n=>this._stopConnection(n),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n,r){let l=T[e.transport];if(l==null)return this._logger.log(d.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(Rn(t,l))if(e.transferFormats.map(m=>I[m]).indexOf(n)>=0){if(l===T.WebSockets&&!this._options.WebSocket||l===T.ServerSentEvents&&!this._options.EventSource)return this._logger.log(d.Debug,`Skipping transport '${T[l]}' because it is not supported in your environment.'`),new Xe(`'${T[l]}' is not supported in your environment.`,l);this._logger.log(d.Debug,`Selecting transport '${T[l]}'.`);try{return this.features.reconnect=l===T.WebSockets?r:void 0,this._constructTransport(l)}catch(m){return m}}else return this._logger.log(d.Debug,`Skipping transport '${T[l]}' because it does not support the requested transfer format '${I[n]}'.`),new Error(`'${T[l]}' does not support ${I[n]}.`);else return this._logger.log(d.Debug,`Skipping transport '${T[l]}' because it was disabled by the client.`),new Ye(`'${T[l]}' is disabled by the client.`,l)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(d.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(d.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(d.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(d.Error,`Connection disconnected with error '${e}'.`):this._logger.log(d.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(d.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(d.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!w.isBrowser)throw new Error(`Cannot resolve '${e}'.`);let t=window.document.createElement("a");return t.href=e,this._logger.log(d.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){let t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";let n=new URLSearchParams(t.searchParams);return n.has("negotiateVersion")||n.append("negotiateVersion",this._negotiateVersion.toString()),n.has("useStatefulReconnect")?n.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&n.append("useStatefulReconnect","true"),t.search=n.toString(),t.toString()}};function Rn(i,e){return!i||(e&i)!==0}var bt=class i{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new _e,this._transportResult=new _e,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new _e),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){return h(this,null,function*(){for(;;){if(yield this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new _e;let e=this._transportResult;this._transportResult=void 0;let t=typeof this._buffer[0]=="string"?this._buffer.join(""):i._concatBuffers(this._buffer);this._buffer.length=0;try{yield this._transport.send(t),e.resolve()}catch(n){e.reject(n)}}})}static _concatBuffers(e){let t=e.map(l=>l.byteLength).reduce((l,u)=>l+u),n=new Uint8Array(t),r=0;for(let l of e)n.set(new Uint8Array(l),r),r+=l.byteLength;return n.buffer}},_e=class{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}};var $n="json",pt=class{constructor(){this.name=$n,this.version=2,this.transferFormat=I.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=z.instance);let n=$.parse(e),r=[];for(let l of n){let u=JSON.parse(l);if(typeof u.type!="number")throw new Error("Invalid payload.");switch(u.type){case _.Invocation:this._isInvocationMessage(u);break;case _.StreamItem:this._isStreamItemMessage(u);break;case _.Completion:this._isCompletionMessage(u);break;case _.Ping:break;case _.Close:break;case _.Ack:this._isAckMessage(u);break;case _.Sequence:this._isSequenceMessage(u);break;default:t.log(d.Information,"Unknown message type '"+u.type+"' ignored.");continue}r.push(u)}return r}writeMessage(e){return $.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}};var Nn={trace:d.Trace,debug:d.Debug,info:d.Information,information:d.Information,warn:d.Warning,warning:d.Warning,error:d.Error,critical:d.Critical,none:d.None};function Hn(i){let e=Nn[i.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${i}`)}var ye=class{configureLogging(e){if(y.isRequired(e,"logging"),Ln(e))this.logger=e;else if(typeof e=="string"){let t=Hn(e);this.logger=new Y(t)}else this.logger=new Y(e);return this}withUrl(e,t){return y.isRequired(e,"url"),y.isNotEmpty(e,"url"),this.url=e,typeof t=="object"?this.httpConnectionOptions=M(M({},this.httpConnectionOptions),t):this.httpConnectionOptions=Q(M({},this.httpConnectionOptions),{transport:t}),this}withHubProtocol(e){return y.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new be(e):this.reconnectPolicy=e:this.reconnectPolicy=new be,this}withServerTimeout(e){return y.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return y.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e?.bufferSize,this}build(){let e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");let t=new gt(this.url,e);return lt.create(t,this.logger||z.instance,this.protocol||new pt,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}};function Ln(i){return i.log!==void 0}var ve=class i{constructor(e){this.http=e;this.initHub(),this.startMessagePolling()}baseUrl="/api/chat";activeChatSessions=new Map;messageSubjects=new Map;destroy$=new ee;hub;initHub(){let e="/hubs/chat",t=localStorage.getItem("auth_token"),n=()=>t||"";this.hub=new ye().withUrl(e,{withCredentials:!0,accessTokenFactory:n}).withAutomaticReconnect().build(),this.hub.start().catch(r=>console.error("SignalR connection error",r)),this.hub.on("ReceiveMessage",r=>{let l=this.activeChatSessions.get(r.sessionId);if(!l)return;let u={id:r.messageId??r.id,chatSessionId:r.sessionId,senderId:r.senderId,senderName:r.senderName??"",senderType:r.senderType,message:r.message,timestamp:new Date(r.timestamp),isRead:!1,messageType:r.messageType??"text"};l.messages.push(u),this.messageSubjects.get(l.id)?.next(l.messages)})}startChatSession(e){return h(this,null,function*(){try{let t=yield this.http.post(`${this.baseUrl}/start-session`,e).toPromise();if(t)return this.activeChatSessions.set(t.id,t),this.messageSubjects.set(t.id,new ft(t.messages||[])),this.hub.invoke("JoinChatSession",t.id).catch(console.error),yield this.notifyMobileAppToStartChat(t),t;throw new Error("Failed to start chat session")}catch(t){throw console.error("Error starting chat session:",t),t}})}sendMessage(e){return h(this,null,function*(){try{let t=yield this.http.post(`${this.baseUrl}/send-message`,{sessionId:e.chatSessionId,senderId:e.senderType==="admin"?e.senderType:"",senderType:e.senderType,content:e.message,messageType:"text"}).toPromise();if(t){let n=this.activeChatSessions.get(e.chatSessionId);return n&&(n.messages.push(t),n.lastMessageAt=t.timestamp,this.messageSubjects.get(e.chatSessionId)?.next(n.messages)),yield this.notifyMobileAppOfMessage(t),this.hub.invoke("SendMessage",e.chatSessionId,e.message,e.senderType).catch(console.error),t}throw new Error("Failed to send message")}catch(t){throw console.error("Error sending message:",t),t}})}getMessages(e){let t=this.messageSubjects.get(e);if(t)return t.asObservable();let n=new ft([]);return this.messageSubjects.set(e,n),this.loadMessages(e),n.asObservable()}getChatSessionByDeliveryId(e){for(let t of this.activeChatSessions.values())if(t.deliveryId===e)return t;return null}loadMessages(e){return h(this,null,function*(){try{let t=yield this.http.get(`${this.baseUrl}/session/${e}/messages`).toPromise();if(t){let n=this.messageSubjects.get(e);n&&n.next(t)}}catch(t){console.error("Error loading messages:",t)}})}startMessagePolling(){xe(3e3).pipe(X(this.destroy$)).subscribe(()=>{this.pollForNewMessages()})}pollForNewMessages(){return h(this,null,function*(){for(let e of this.activeChatSessions.keys())try{let t=this.getLastMessage(e),n=t?t.timestamp.toISOString():new Date(0).toISOString(),r=new _t().set("sessionId",e).set("since",n),l=yield this.http.get(`${this.baseUrl}/messages/new`,{params:r}).toPromise();if(l&&l.length>0){let u=this.activeChatSessions.get(e);u&&(u.messages.push(...l),u.lastMessageAt=l[l.length-1].timestamp,this.messageSubjects.get(e)?.next(u.messages))}}catch(t){console.error("Error polling for new messages:",t)}})}getLastMessage(e){let t=this.messageSubjects.get(e);if(t){let n=t.value;return n.length>0?n[n.length-1]:null}return null}notifyMobileAppToStartChat(e){return h(this,null,function*(){try{let t={type:"start_chat",sessionId:e.id,deliveryId:e.deliveryId,customerId:e.customerId,adminName:e.adminName,timestamp:new Date};yield this.http.post(`${this.baseUrl}/notify/mobile`,t).toPromise()}catch(t){console.error("Error notifying mobile app to start chat:",t)}})}notifyMobileAppOfMessage(e){return h(this,null,function*(){try{let t={type:"new_message",messageId:e.id,sessionId:e.chatSessionId,senderType:e.senderType,message:e.message,timestamp:e.timestamp};yield this.http.post(`${this.baseUrl}/notify/mobile`,t).toPromise()}catch(t){console.error("Error notifying mobile app of message:",t)}})}markMessagesAsRead(e,t){return h(this,null,function*(){try{yield this.http.post(`${this.baseUrl}/messages/read`,{sessionId:e,messageIds:t}).toPromise()}catch(n){console.error("Error marking messages as read:",n)}})}closeChatSession(e){return h(this,null,function*(){try{yield this.http.post(`${this.baseUrl}/sessions/${e}/close`,{}).toPromise(),this.activeChatSessions.delete(e),this.messageSubjects.delete(e)}catch(t){console.error("Error closing chat session:",t)}})}getChatHistory(e){return h(this,null,function*(){try{let t=new _t().set("deliveryId",e);return(yield this.http.get(`${this.baseUrl}/sessions/history`,{params:t}).toPromise())||[]}catch(t){return console.error("Error getting chat history:",t),[]}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||i)(xt(Rt))};static \u0275prov=yt({token:i,factory:i.\u0275fac,providedIn:"root"})};var Vn=["chatContent"];function qn(i,e){if(i&1&&(o(0,"div",28)(1,"mat-icon"),c(2),s()()),i&2){let t=S().$implicit;a(2),g(t.senderType==="admin"?"admin_panel_settings":"person")}}function Jn(i,e){if(i&1&&(o(0,"div",29)(1,"span",30),c(2),s(),o(3,"span",31),c(4),s()()),i&2){let t=S().$implicit,n=S(2);a(2),g(t.senderName),a(2),g(n.formatTime(t.timestamp))}}function Kn(i,e){i&1&&(o(0,"mat-icon",35),c(1,"done_all"),s())}function Xn(i,e){i&1&&(o(0,"mat-icon",36),c(1,"done"),s())}function Yn(i,e){if(i&1&&(o(0,"div",32),P(1,Kn,2,0,"mat-icon",33)(2,Xn,2,0,"mat-icon",34),s()),i&2){let t=S().$implicit;a(),C("ngIf",t.isRead),a(),C("ngIf",!t.isRead)}}function Gn(i,e){if(i&1&&(o(0,"div",22),P(1,qn,3,1,"div",23),o(2,"div",24),P(3,Jn,5,2,"div",25),A(4,"div",26),P(5,Yn,3,2,"div",27),s()()),i&2){let t=e.$implicit;k("message-"+t.senderType),N("system-message",t.messageType==="system"),a(),C("ngIf",t.messageType!=="system"),a(2),C("ngIf",t.messageType!=="system"),a(),C("innerHTML",t.message,we),a(),C("ngIf",t.senderType==="admin")}}function Qn(i,e){if(i&1&&(o(0,"div",20),P(1,Gn,6,8,"div",21),s()),i&2){let t=S();a(),C("ngForOf",t.messages)}}function Zn(i,e){if(i&1&&(o(0,"div",37)(1,"mat-icon"),c(2,"chat_bubble_outline"),s(),o(3,"h4"),c(4),s(),o(5,"p"),c(6),s()()),i&2){let t=S();a(4),g(t.translationService.translate("noMessagesYet")||"\u0644\u0627 \u062A\u0648\u062C\u062F \u0631\u0633\u0627\u0626\u0644 \u0628\u0639\u062F"),a(2),g(t.translationService.translate("startConversation")||"\u0627\u0628\u062F\u0623 \u0627\u0644\u0645\u062D\u0627\u062F\u062B\u0629 \u0645\u0639 \u0627\u0644\u0639\u0645\u064A\u0644")}}function ei(i,e){if(i&1&&(o(0,"div",38),A(1,"mat-spinner",39),o(2,"span"),c(3),s()()),i&2){let t=S();a(3),g(t.translationService.translate("customerTyping")||"\u0627\u0644\u0639\u0645\u064A\u0644 \u064A\u0643\u062A\u0628...")}}function ti(i,e){i&1&&(o(0,"mat-icon"),c(1,"send"),s())}function ni(i,e){i&1&&A(0,"mat-spinner",39)}var ht=class i{constructor(e,t,n,r){this.dialogRef=e;this.data=t;this.translationService=n;this.chatService=r}chatContent;messages=[];newMessage="";isSending=!1;isTyping=!1;chatSession=null;destroy$=new ee;ngOnInit(){this.initializeChat(),this.startPollingForMessages()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeChat(){return h(this,null,function*(){try{if(!this.data.delivery.id)throw new Error("Delivery ID is required for chat session");this.chatSession=this.chatService.getChatSessionByDeliveryId(this.data.delivery.id),this.chatSession||(this.chatSession=yield this.chatService.startChatSession({deliveryId:this.data.delivery.id,customerId:this.data.delivery.customerPhoneNumber||"",customerPhoneNumber:this.data.delivery.customerPhoneNumber||"",adminId:this.data.currentAdminId,adminName:this.data.currentAdminName})),this.chatSession&&this.chatService.getMessages(this.chatSession.id).pipe(X(this.destroy$)).subscribe(e=>{this.messages=e,this.scrollToBottom()})}catch(e){console.error("Error initializing chat:",e),this.addSystemMessage("\u062E\u0637\u0623 \u0641\u064A \u0628\u062F\u0621 \u0627\u0644\u0645\u062D\u0627\u062F\u062B\u0629")}})}startPollingForMessages(){}onSendMessage(e){return h(this,null,function*(){if(e&&e.key==="Enter"&&!e.shiftKey&&e.preventDefault(),!this.newMessage.trim()||this.isSending||!this.chatSession)return;this.isSending=!0;let t=this.newMessage.trim();this.newMessage="";try{yield this.chatService.sendMessage({chatSessionId:this.chatSession.id,message:t,senderType:"admin"});let n=this.messages.filter(r=>!r.isRead&&r.senderType==="customer");n.length>0&&(yield this.chatService.markMessagesAsRead(this.chatSession.id,n.map(r=>r.id)))}catch(n){console.error("Error sending message:",n),this.addSystemMessage("\u062E\u0637\u0623 \u0641\u064A \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u0633\u0627\u0644\u0629")}finally{this.isSending=!1}})}addSystemMessage(e){let t={id:Date.now().toString(),chatSessionId:this.chatSession?.id||"",senderId:"system",senderName:"\u0627\u0644\u0646\u0638\u0627\u0645",senderType:"admin",message:e,timestamp:new Date,isRead:!0,messageType:"system"};this.messages.push(t),this.scrollToBottom()}scrollToBottom(){setTimeout(()=>{this.chatContent&&(this.chatContent.nativeElement.scrollTop=this.chatContent.nativeElement.scrollHeight)},100)}onClose(){if(this.chatSession){let e=this.messages.filter(t=>!t.isRead&&t.senderType==="customer");e.length>0&&this.chatService.markMessagesAsRead(this.chatSession.id,e.map(t=>t.id))}this.dialogRef.close()}onCallCustomer(){if(this.data.delivery.customerPhoneNumber){let e=`tel:${this.data.delivery.customerPhoneNumber}`;window.open(e,"_self")}else alert("\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641 \u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631")}onViewDeliveryDetails(){this.dialogRef.close({action:"viewDetails"})}formatTime(e){return e.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})}getCustomerStatusClass(e){switch(e){case"\u0646\u0634\u064A\u0637":return"status-active";default:return"status-normal"}}getCustomerStatusIcon(e){switch(e){case"\u0646\u0634\u064A\u0637":return"person";default:return"person_outline"}}static \u0275fac=function(t){return new(t||i)(O(Ne),O(He),O(ce),O(ve))};static \u0275cmp=te({type:i,selectors:[["app-customer-chat-dialog"]],viewQuery:function(t,n){if(t&1&&Mt(Vn,5),t&2){let r;Pt(r=Dt())&&(n.chatContent=r.first)}},decls:45,vars:20,consts:[["chatContent",""],["noMessages",""],[1,"customer-chat-dialog"],[1,"chat-header"],[1,"customer-info"],[1,"customer-avatar"],[1,"customer-details"],["mat-icon-button","",1,"close-btn",3,"click"],[1,"chat-content"],["class","chat-messages",4,"ngIf","ngIfElse"],["class","typing-indicator",4,"ngIf"],[1,"chat-input"],["appearance","outline",1,"message-input"],["matInput","","rows","2","maxlength","500",3,"ngModelChange","keydown.enter","ngModel","disabled"],["align","end"],["mat-fab","","color","primary",1,"send-btn",3,"click","disabled"],[4,"ngIf"],["diameter","20",4,"ngIf"],[1,"chat-actions"],["mat-stroked-button","",1,"action-btn",3,"click"],[1,"chat-messages"],["class","message",3,"class","system-message",4,"ngFor","ngForOf"],[1,"message"],["class","message-avatar",4,"ngIf"],[1,"message-content"],["class","message-header",4,"ngIf"],[1,"message-text",3,"innerHTML"],["class","message-status",4,"ngIf"],[1,"message-avatar"],[1,"message-header"],[1,"sender-name"],[1,"message-time"],[1,"message-status"],["class","read-icon",4,"ngIf"],["class","sent-icon",4,"ngIf"],[1,"read-icon"],[1,"sent-icon"],[1,"no-messages"],[1,"typing-indicator"],["diameter","20"]],template:function(t,n){if(t&1){let r=Me();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"mat-icon"),c(5,"person"),s()(),o(6,"div",6)(7,"h3"),c(8),s(),o(9,"p"),c(10),s(),o(11,"mat-chip-set")(12,"mat-chip")(13,"mat-icon"),c(14),s(),c(15),s()()()(),o(16,"button",7),x("click",function(){return j(r),B(n.onClose())}),o(17,"mat-icon"),c(18,"close"),s()()(),o(19,"div",8,0),P(21,Qn,2,1,"div",9)(22,Zn,7,2,"ng-template",null,1,Ot)(24,ei,4,1,"div",10),s(),o(25,"div",11)(26,"mat-form-field",12)(27,"mat-label"),c(28),s(),o(29,"textarea",13),re("ngModelChange",function(u){return j(r),ie(n.newMessage,u)||(n.newMessage=u),B(u)}),x("keydown.enter",function(u){return j(r),B(n.onSendMessage(u))}),c(30,"          "),s(),o(31,"mat-hint",14),c(32),s()(),o(33,"button",15),x("click",function(){return j(r),B(n.onSendMessage())}),P(34,ti,2,0,"mat-icon",16)(35,ni,1,0,"mat-spinner",17),s()(),o(36,"div",18)(37,"button",19),x("click",function(){return j(r),B(n.onCallCustomer())}),o(38,"mat-icon"),c(39,"phone"),s(),c(40),s(),o(41,"button",19),x("click",function(){return j(r),B(n.onViewDeliveryDetails())}),o(42,"mat-icon"),c(43,"local_shipping"),s(),c(44),s()()()}if(t&2){let r=It(23);N("rtl",n.translationService.isRTL()),a(8),g(n.data.delivery.customerName||"\u0639\u0645\u064A\u0644 \u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(2),g(n.data.delivery.customerPhoneNumber||"\u0631\u0642\u0645 \u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),a(2),k(n.getCustomerStatusClass(n.data.delivery.customerStatus||"")),a(2),g(n.getCustomerStatusIcon(n.data.delivery.customerStatus||"")),a(),f(" ",n.data.delivery.customerStatus," "),a(6),C("ngIf",n.messages.length>0)("ngIfElse",r),a(3),C("ngIf",n.isTyping),a(4),g(n.translationService.translate("typeMessage")||"\u0627\u0643\u062A\u0628 \u0631\u0633\u0627\u0644\u0629..."),a(),ne("ngModel",n.newMessage),C("disabled",n.isSending),a(3),f("",n.newMessage.length,"/500"),a(),C("disabled",!n.newMessage.trim()||n.isSending),a(),C("ngIf",!n.isSending),a(),C("ngIf",n.isSending),a(5),f(" ",n.translationService.translate("call")||"\u0627\u062A\u0635\u0627\u0644"," "),a(4),f(" ",n.translationService.translate("deliveryDetails")||"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062A\u0648\u0635\u064A\u0644"," ")}},dependencies:[oe,De,Ie,Re,ke,Oe,Lt,Ae,Le,le,se,ae,Wt,me,ue,de,Ve,ze,Ee,Te,Nt,$e,he,ge,pe,Je,qe],styles:[".customer-chat-dialog[_ngcontent-%COMP%]{width:500px;height:600px;display:flex;flex-direction:column;background:#fff}.chat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #e0e0e0;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.customer-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.customer-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#fff3;display:flex;align-items:center;justify-content:center;color:#fff}.customer-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600}.customer-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;opacity:.9}.customer-details[_ngcontent-%COMP%]   mat-chip-set[_ngcontent-%COMP%]{margin-top:4px}.customer-details[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{background:#fff3;color:#fff;font-size:.8rem}.close-btn[_ngcontent-%COMP%]{color:#fff}.chat-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;background:#f8f9fa}.chat-messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.message[_ngcontent-%COMP%]{display:flex;gap:8px;max-width:80%}.message-admin[_ngcontent-%COMP%]{flex-direction:row-reverse;align-self:flex-end}.message-customer[_ngcontent-%COMP%]{align-self:flex-start}.message-system[_ngcontent-%COMP%]{align-self:center;justify-content:center;max-width:100%}.message-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.message-admin[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.message-customer[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.message-content[_ngcontent-%COMP%]{flex:1}.message-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.sender-name[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem;color:#2c3e50}.message-time[_ngcontent-%COMP%]{font-size:.8rem;color:#7f8c8d}.message-text[_ngcontent-%COMP%]{background:#fff;padding:12px 16px;border-radius:18px;box-shadow:0 1px 3px #0000001a;word-wrap:break-word;line-height:1.4}.message-admin[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.message-customer[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:#fff;color:#2c3e50}.system-message[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;text-align:center;font-style:italic}.message-status[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:4px}.read-icon[_ngcontent-%COMP%]{color:#4caf50;font-size:16px}.sent-icon[_ngcontent-%COMP%]{color:#7f8c8d;font-size:16px}.no-messages[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#7f8c8d}.no-messages[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;color:#bdc3c7}.no-messages[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#2c3e50}.no-messages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.typing-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;color:#7f8c8d;font-size:.9rem}.chat-input[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:12px;padding:16px 20px;border-top:1px solid #e0e0e0;background:#fff}.message-input[_ngcontent-%COMP%]{flex:1}.send-btn[_ngcontent-%COMP%]{width:48px;height:48px}.chat-actions[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px 20px;border-top:1px solid #e0e0e0;background:#f8f9fa}.action-btn[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:8px}.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.status-normal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3);color:#2c3e50}.rtl[_ngcontent-%COMP%]{direction:rtl}.rtl[_ngcontent-%COMP%]   .chat-header[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]{flex-direction:row-reverse}.rtl[_ngcontent-%COMP%]   .message-admin[_ngcontent-%COMP%]{flex-direction:row}.rtl[_ngcontent-%COMP%]   .message-customer[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .chat-actions[_ngcontent-%COMP%]{flex-direction:row-reverse}@media (max-width: 768px){.customer-chat-dialog[_ngcontent-%COMP%]{width:95vw;height:90vh}.message[_ngcontent-%COMP%]{max-width:90%}.chat-input[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.send-btn[_ngcontent-%COMP%]{align-self:flex-end;margin-top:8px}}"]})};var ii=()=>[10,25,50];function ri(i,e){if(i&1&&(o(0,"mat-option",56),c(1),s()),i&2){let t=e.$implicit;C("value",t),a(),g(t)}}function oi(i,e){if(i&1&&(o(0,"div",57),A(1,"mat-spinner"),o(2,"p"),c(3),s()()),i&2){let t=S();a(3),g(t.translationService.translate("loading")||"Loading...")}}function ai(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("orderId")||"\u0627\u0644\u0631\u0642\u0645"," ")}}function si(i,e){if(i&1&&(o(0,"td",78)(1,"div",79)(2,"span",80),c(3),s()()()),i&2){let t=e.$implicit;a(3),f("#",t.id)}}function li(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("orderTime")||"\u0648\u0642\u062A \u0627\u0644\u0637\u0644\u0628"," ")}}function ci(i,e){if(i&1&&(o(0,"td",78)(1,"div",81)(2,"mat-icon"),c(3,"schedule"),s(),o(4,"span"),c(5),s()()()),i&2){let t=e.$implicit,n=S(3);a(5),g(n.formatTime(t.orderTime))}}function di(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("customerName")||"\u0627\u0633\u0645 \u0627\u0644\u0632\u0628\u0648\u0646"," ")}}function ui(i,e){if(i&1&&(o(0,"td",78)(1,"div",82)(2,"div",83)(3,"mat-icon"),c(4,"person"),s()(),o(5,"div",84)(6,"span",85),c(7),s(),o(8,"span",86),c(9),s()()()()),i&2){let t=e.$implicit,n=S(3);a(7),g(n.getCustomerDisplayName(t)),a(2),g(t.customerPhoneNumber)}}function mi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("storeName")||"\u0627\u0644\u0645\u062A\u062C\u0631"," ")}}function gi(i,e){if(i&1&&(o(0,"td",78)(1,"div",87)(2,"mat-icon"),c(3,"store"),s(),o(4,"span"),c(5),s()()()),i&2){let t=e.$implicit;a(5),g(t.storeName)}}function pi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("city")||"\u0627\u0644\u0645\u062F\u064A\u0646\u0629"," ")}}function hi(i,e){if(i&1&&(o(0,"td",78)(1,"div",88)(2,"mat-icon"),c(3,"location_on"),s(),o(4,"span"),c(5),s()()()),i&2){let t=e.$implicit;a(5),g(t.city)}}function fi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("amount")||"\u0627\u0644\u0645\u0628\u0644\u063A"," ")}}function _i(i,e){if(i&1&&(o(0,"td",78)(1,"div",89)(2,"span",90),c(3),s()()()),i&2){let t=e.$implicit,n=S(3);a(3),g(n.formatCurrency(t.amount))}}function vi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("deliveryTimeDifference")||"\u0641\u0627\u0631\u0642 \u0632\u0645\u0646 \u0627\u0644\u062A\u0648\u0635\u064A\u0644"," ")}}function Ci(i,e){if(i&1&&(o(0,"td",78)(1,"mat-chip-set")(2,"mat-chip")(3,"mat-icon"),c(4),s(),c(5),s()()()),i&2){let t=e.$implicit,n=S(3);a(2),k(n.getTimeDifferenceClass(t.deliveryTimeDifference)),a(2),g(n.getTimeDifferenceIcon(t.deliveryTimeDifference)),a(),f(" ",t.deliveryTimeDifference," ")}}function bi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("customerStatus")||"\u062D\u0627\u0644\u0629 \u0627\u0644\u0632\u0628\u0648\u0646"," ")}}function Si(i,e){if(i&1&&(o(0,"td",78)(1,"mat-chip-set")(2,"mat-chip")(3,"mat-icon"),c(4),s(),c(5),s()()()),i&2){let t=e.$implicit,n=S(3);a(2),k(n.getCustomerStatusClass(t.customerStatus)),a(2),g(n.getCustomerStatusIcon(t.customerStatus)),a(),f(" ",t.customerStatus," ")}}function yi(i,e){if(i&1&&(o(0,"th",77),c(1),o(2,"mat-icon"),c(3,"arrow_drop_down"),s()()),i&2){let t=S(3);a(),f(" ",t.translationService.translate("orderStatus")||"\u062D\u0627\u0644\u0629 \u0627\u0644\u0637\u0644\u0628"," ")}}function xi(i,e){if(i&1&&(o(0,"td",78)(1,"mat-chip-set")(2,"mat-chip")(3,"mat-icon"),c(4),s(),c(5),s()()()),i&2){let t=e.$implicit,n=S(3);a(2),k(n.getOrderStatusClass(t.orderStatus)),a(2),g(n.getOrderStatusIcon(t.orderStatus)),a(),f(" ",t.orderStatus," ")}}function wi(i,e){if(i&1&&(o(0,"th",91),c(1),s()),i&2){let t=S(3);a(),g(t.translationService.translate("actions")||"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A")}}function Mi(i,e){if(i&1){let t=Me();o(0,"td",78)(1,"div",92)(2,"button",93),x("click",function(){let r=j(t).$implicit,l=S(3);return B(l.viewDetails(r))}),o(3,"mat-icon"),c(4,"visibility"),s()(),o(5,"button",94),x("click",function(){let r=j(t).$implicit,l=S(3);return B(l.contactCustomer(r))}),o(6,"mat-icon"),c(7,"phone"),s()()()()}if(i&2){let t=S(3);a(2),C("matTooltip",Pe(t.translationService.translate("viewDetails")||"View Details")),a(3),C("matTooltip",Pe(t.translationService.translate("contactCustomer")||"Contact Customer"))}}function Pi(i,e){i&1&&A(0,"tr",95)}function Di(i,e){i&1&&A(0,"tr",96)}function Ii(i,e){if(i&1&&(o(0,"table",61),H(1,62),P(2,ai,4,1,"th",63)(3,si,4,1,"td",64),L(),H(4,65),P(5,li,4,1,"th",63)(6,ci,6,1,"td",64),L(),H(7,66),P(8,di,4,1,"th",63)(9,ui,10,2,"td",64),L(),H(10,67),P(11,mi,4,1,"th",63)(12,gi,6,1,"td",64),L(),H(13,68),P(14,pi,4,1,"th",63)(15,hi,6,1,"td",64),L(),H(16,69),P(17,fi,4,1,"th",63)(18,_i,4,1,"td",64),L(),H(19,70),P(20,vi,4,1,"th",63)(21,Ci,6,4,"td",64),L(),H(22,71),P(23,bi,4,1,"th",63)(24,Si,6,4,"td",64),L(),H(25,72),P(26,yi,4,1,"th",63)(27,xi,6,4,"td",64),L(),H(28,73),P(29,wi,2,1,"th",74)(30,Mi,8,4,"td",64),L(),P(31,Pi,1,0,"tr",75)(32,Di,1,0,"tr",76),s()),i&2){let t=S(2);C("dataSource",t.filteredDeliveries),a(31),C("matHeaderRowDef",t.displayedColumns),a(),C("matRowDefColumns",t.displayedColumns)}}function Ti(i,e){if(i&1&&(o(0,"div",97)(1,"mat-icon"),c(2,"inbox"),s(),o(3,"h3"),c(4),s(),o(5,"p"),c(6),s()()),i&2){let t=S(2);a(4),g(t.translationService.translate("noCurrentDeliveries")||"No Current Deliveries"),a(2),g(t.translationService.translate("noCurrentDeliveriesMessage")||"There are no active delivery orders at the moment.")}}function Ei(i,e){if(i&1&&(o(0,"div",58),P(1,Ii,33,3,"table",59)(2,Ti,7,2,"div",60),s()),i&2){let t=S();a(),C("ngIf",t.filteredDeliveries.length>0),a(),C("ngIf",t.filteredDeliveries.length===0)}}function ki(i,e){if(i&1&&(o(0,"div",98)(1,"div",99)(2,"mat-icon"),c(3),s()(),o(4,"div",100)(5,"div",101),c(6),s(),o(7,"div",102),c(8),s()(),o(9,"div",103)(10,"mat-icon"),c(11),s()()()),i&2){let t=e.$implicit;a(),k(t.type),a(2),g(t.icon),a(3),g(t.title),a(2),g(t.time),a(),k(t.status),a(2),g(t.statusIcon)}}var xn=class i{constructor(e,t,n,r){this.dashboardService=e;this.translationService=t;this.dialog=n;this.chatService=r}currentDeliveries=[];filteredDeliveries=[];displayedColumns=["id","orderTime","customerName","storeName","city","amount","deliveryTimeDifference","customerStatus","orderStatus","actions"];isLoading=!1;error=null;destroy$=new ee;pageIndex=0;pageSize=10;totalItems=0;searchTerm="";selectedStatus="";selectedCity="";selectedTimeFilter="day";currentDate=new Date;liveTime="";previousPeriodData={totalDeliveries:0,onTimeDeliveries:0,delayedDeliveries:0,totalValue:0};Math=Math;recentActivities=[];ngOnInit(){return h(this,null,function*(){this.loadCurrentDeliveries(),this.startLiveTime(),yield this.loadPreviousPeriodData(),yield this.loadRecentActivities()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadCurrentDeliveries(e=1,t=10){this.isLoading=!0,this.error=null,this.dashboardService.getCurrentDeliveriesByPageAndPageSizeAndSortByAndSortOrder(e,t,"id","desc").pipe(X(this.destroy$)).subscribe({next:n=>{let r=n;this.currentDeliveries=r?.items||[],this.filteredDeliveries=[...this.currentDeliveries],this.totalItems=r?.totalCount||0,console.log("CurrentDeliveries API result:",n),console.log("Assigned currentDeliveries:",this.currentDeliveries),this.isLoading=!1},error:n=>{console.error("Error loading current deliveries",n),this.error=this.translationService.translate("loadingError"),this.isLoading=!1}})}refreshData(){this.loadCurrentDeliveries()}onPageChange(e){this.pageIndex=e.pageIndex,this.pageSize=e.pageSize,this.loadCurrentDeliveries(this.pageIndex+1,this.pageSize)}formatTime(e){return e}formatCurrency(e){return new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SYP",minimumFractionDigits:0}).format(e)}getTimeDifferenceClass(e){return e.includes("+")?"time-positive":e.includes("-")?"time-negative":"time-neutral"}getCustomerStatusClass(e){switch(e){case"\u0646\u0634\u064A\u0637":return"status-active";default:return"status-normal"}}getOnTimeDeliveriesCount(){return this.currentDeliveries.filter(e=>e.deliveryTimeDifference&&e.deliveryTimeDifference.includes("+")).length}getDelayedDeliveriesCount(){return this.currentDeliveries.filter(e=>e.deliveryTimeDifference&&e.deliveryTimeDifference.includes("-")).length}getTotalValue(){return this.currentDeliveries.reduce((e,t)=>e+(t.amount||0),0)}getUniqueCities(){let e=this.currentDeliveries.map(t=>t.city).filter(t=>!!t);return[...new Set(e)]}applyFilters(){this.filteredDeliveries=this.currentDeliveries.filter(e=>{let t=!this.searchTerm||e.customerName?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.storeName?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.id?.toString().includes(this.searchTerm),n=!this.selectedStatus||e.customerStatus===this.selectedStatus,r=!this.selectedCity||e.city===this.selectedCity;return t&&n&&r})}getTimeDifferenceIcon(e){return e.includes("+")?"schedule":e.includes("-")?"warning":"schedule"}getCustomerStatusIcon(e){switch(e){case"\u0646\u0634\u064A\u0637":return"person";default:return"person_outline"}}getOrderStatusClass(e){switch(e){case(this.translationService.translate("delivering")||"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0648\u0635\u064A\u0644"):return"status-active";case(this.translationService.translate("out_for_delivery")||"\u0641\u064A \u0627\u0644\u0637\u0631\u064A\u0642"):return"status-normal";default:return"status-normal"}}getOrderStatusIcon(e){switch(e){case(this.translationService.translate("delivering")||"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0648\u0635\u064A\u0644"):return"local_shipping";case(this.translationService.translate("out_for_delivery")||"\u0641\u064A \u0627\u0644\u0637\u0631\u064A\u0642"):return"directions_car";default:return"pending"}}viewDetails(e){try{if(!e.id){alert("Delivery ID is missing. Cannot view details.");return}let t={delivery:e,onContactCustomer:r=>this.contactCustomer(r)};this.dialog.open(Ke,{width:"90vw",maxWidth:"800px",maxHeight:"90vh",data:t,disableClose:!1}).afterClosed().subscribe(r=>{r&&console.log("Delivery details dialog closed with result:",r)}),console.log("View details for delivery:",e)}catch(t){console.error("Error viewing delivery details:",t),alert("Error loading delivery details. Please try again.")}}contactCustomer(e){try{if(!e.id){alert("Delivery ID is missing. Cannot start chat session.");return}let t=localStorage.getItem("auth_token"),n="current-admin-id",r="\u0627\u0644\u0645\u062F\u064A\u0631";if(t)try{let m=JSON.parse(atob(t.split(".")[1]));n=m.sub||m.nameid||"current-admin-id",r=m.name||m.email||"\u0627\u0644\u0645\u062F\u064A\u0631"}catch(m){console.error("Error decoding JWT token:",m)}let l={delivery:e,currentAdminId:n,currentAdminName:r};this.dialog.open(ht,{width:"500px",height:"600px",maxHeight:"90vh",data:l,disableClose:!1}).afterClosed().subscribe(m=>{m&&m.action==="viewDetails"&&this.viewDetails(e),console.log("Chat dialog closed with result:",m)}),console.log("Contact customer via chat:",e.customerPhoneNumber)}catch(t){console.error("Error opening chat with customer:",t),alert("Error opening chat. Please try again.")}}exportData(){if(this.filteredDeliveries.length===0){alert("No data to export");return}let t=[["Order ID","Customer Name","Phone Number","Store Name","City","Amount","Order Time","Delivery Time Difference","Customer Status","Order Status"].join(","),...this.filteredDeliveries.map(u=>[u.id,`"${u.customerName||""}"`,u.customerPhoneNumber||"",`"${u.storeName||""}"`,`"${u.city||""}"`,u.amount||0,`"${u.orderTime||""}"`,`"${u.deliveryTimeDifference||""}"`,`"${u.customerStatus||""}"`,`"${u.orderStatus||""}"`].join(","))].join(`
`),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(n);r.setAttribute("href",l),r.setAttribute("download",`current-deliveries-${new Date().toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),console.log("Data exported successfully")}startLiveTime(){this.updateLiveTime(),xe(1e3).pipe(X(this.destroy$)).subscribe(()=>this.updateLiveTime())}updateLiveTime(){let e=new Date;this.liveTime=e.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}setTimeFilter(e){this.selectedTimeFilter=e,this.loadCurrentDeliveries()}loadPreviousPeriodData(){return h(this,null,function*(){try{let e=yield this.dashboardService.getPreviousPeriodData().toPromise();e&&(this.previousPeriodData={totalDeliveries:e.totalDeliveries||0,onTimeDeliveries:e.onTimeDeliveries||0,delayedDeliveries:e.delayedDeliveries||0,totalValue:e.totalValue||0})}catch(e){console.error("Error loading previous period data:",e),this.previousPeriodData={totalDeliveries:0,onTimeDeliveries:0,delayedDeliveries:0,totalValue:0}}})}loadRecentActivities(){return h(this,null,function*(){try{let e=yield this.dashboardService.getRecentActivities().toPromise();this.recentActivities=e||[]}catch(e){console.error("Error loading recent activities:",e),this.recentActivities=[]}})}getTrendPercentage(e,t){return t===0?0:Math.round((e-t)/t*100)}getTrendClass(e){return e>0?"positive":e<0?"negative":"neutral"}getTrendIcon(e){return e>0?"arrow_upward":e<0?"arrow_downward":"trending_flat"}navigateToCompletedOrders(){console.log("Navigate to completed orders"),alert("Navigate to completed orders - This would open the completed orders page")}navigateToCancelledOrders(){console.log("Navigate to cancelled orders"),alert("Navigate to cancelled orders - This would open the cancelled orders page")}navigateToOverview(){console.log("Navigate to overview"),alert("Navigate to overview - This would open the dashboard overview")}navigateToRestaurants(){console.log("Navigate to restaurants"),alert("Navigate to restaurants - This would open the restaurants management page")}getCustomerDisplayName(e){return e.customerName&&e.customerName.match(/^\d/)?`\u0639\u0645\u064A\u0644 ${e.customerName.slice(-4)}`:e.customerName||"\u0639\u0645\u064A\u0644 \u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}static \u0275fac=function(t){return new(t||i)(O(Qt),O(ce),O(qt),O(ve))};static \u0275cmp=te({type:i,selectors:[["app-current-deliveries"]],decls:173,vars:104,consts:[[1,"current-deliveries-container"],[1,"page-header"],[1,"header-content"],[1,"header-info"],[1,"header-subtitle"],[1,"date-time-section"],[1,"current-time"],[1,"live-time",3,"innerHTML"],[1,"header-actions"],["mat-icon-button","",1,"refresh-btn",3,"click","disabled"],["mat-raised-button","","color","primary",1,"export-btn",3,"click"],[1,"time-filters-section"],[1,"time-filters"],["mat-button","",1,"filter-btn",3,"click"],[1,"stats-section"],[1,"stat-card","total-deliveries"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-value"],[1,"stat-change"],[1,"stat-label"],[1,"progress-bar"],[1,"progress-fill"],[1,"stat-card","on-time-deliveries"],[1,"progress-fill","success"],[1,"stat-card","delayed-deliveries"],[1,"progress-fill","warning"],[1,"stat-card","total-value"],[1,"progress-fill","info"],[1,"filters-section"],[1,"filter-group"],["appearance","outline",1,"filter-field"],["matInput","",3,"ngModelChange","input","ngModel","placeholder"],["matSuffix",""],[3,"ngModelChange","selectionChange","ngModel"],["value",""],["value","\u0646\u0634\u064A\u0637"],["value","\u0639\u0627\u062F\u064A"],[3,"value",4,"ngFor","ngForOf"],[1,"data-card"],[1,"card-header"],["mat-card-avatar","",1,"deliveries-icon"],[1,"count-badge"],["class","loading-container",4,"ngIf"],["class","table-container",4,"ngIf"],["showFirstLastButtons","",3,"page","length","pageIndex","pageSize","pageSizeOptions"],[1,"quick-actions-section"],[1,"section-title"],[1,"quick-actions-grid"],["mat-raised-button","","color","primary",1,"action-btn",3,"click"],["mat-raised-button","","color","accent",1,"action-btn",3,"click"],["mat-raised-button","","color","warn",1,"action-btn",3,"click"],["mat-raised-button","",1,"action-btn",3,"click"],[1,"recent-activity-section"],[1,"activity-list"],["class","activity-item",4,"ngFor","ngForOf"],[3,"value"],[1,"loading-container"],[1,"table-container"],["mat-table","","class","deliveries-table",3,"dataSource",4,"ngIf"],["class","empty-state",4,"ngIf"],["mat-table","",1,"deliveries-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","sortable-header",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orderTime"],["matColumnDef","customerName"],["matColumnDef","storeName"],["matColumnDef","city"],["matColumnDef","amount"],["matColumnDef","deliveryTimeDifference"],["matColumnDef","customerStatus"],["matColumnDef","orderStatus"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","delivery-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"sortable-header"],["mat-cell",""],[1,"order-id-cell"],[1,"order-id"],[1,"time-cell"],[1,"customer-cell"],[1,"customer-avatar"],[1,"customer-info"],[1,"customer-name"],[1,"customer-phone"],[1,"store-cell"],[1,"location-cell"],[1,"amount-cell"],[1,"amount-value"],["mat-header-cell",""],[1,"action-buttons"],["mat-icon-button","",1,"action-btn","view-btn",3,"click","matTooltip"],["mat-icon-button","",1,"action-btn","contact-btn",3,"click","matTooltip"],["mat-header-row",""],["mat-row","",1,"delivery-row"],[1,"empty-state"],[1,"activity-item"],[1,"activity-icon"],[1,"activity-content"],[1,"activity-title"],[1,"activity-time"],[1,"activity-status"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),c(5),s(),o(6,"p",4),c(7),s()(),o(8,"div",5)(9,"div",6)(10,"mat-icon"),c(11,"schedule"),s(),o(12,"span"),c(13),Et(14,"date"),s()(),A(15,"div",7),s(),o(16,"div",8)(17,"button",9),x("click",function(){return n.refreshData()}),o(18,"mat-icon"),c(19,"refresh"),s()(),o(20,"button",10),x("click",function(){return n.exportData()}),o(21,"mat-icon"),c(22,"download"),s(),c(23),s()()()(),o(24,"div",11)(25,"div",12)(26,"button",13),x("click",function(){return n.setTimeFilter("day")}),o(27,"mat-icon"),c(28,"today"),s(),c(29),s(),o(30,"button",13),x("click",function(){return n.setTimeFilter("week")}),o(31,"mat-icon"),c(32,"date_range"),s(),c(33),s(),o(34,"button",13),x("click",function(){return n.setTimeFilter("month")}),o(35,"mat-icon"),c(36,"calendar_month"),s(),c(37),s(),o(38,"button",13),x("click",function(){return n.setTimeFilter("custom")}),o(39,"mat-icon"),c(40,"tune"),s(),c(41),s()()(),o(42,"div",14)(43,"div",15)(44,"div",16)(45,"mat-icon"),c(46,"local_shipping"),s()(),o(47,"div",17)(48,"div",18),c(49),s(),o(50,"div",19)(51,"mat-icon"),c(52),s(),o(53,"span"),c(54),s()(),o(55,"div",20),c(56),s()(),o(57,"div",21),A(58,"div",22),s()(),o(59,"div",23)(60,"div",16)(61,"mat-icon"),c(62,"schedule"),s()(),o(63,"div",17)(64,"div",18),c(65),s(),o(66,"div",19)(67,"mat-icon"),c(68),s(),o(69,"span"),c(70),s()(),o(71,"div",20),c(72),s()(),o(73,"div",21),A(74,"div",24),s()(),o(75,"div",25)(76,"div",16)(77,"mat-icon"),c(78,"warning"),s()(),o(79,"div",17)(80,"div",18),c(81),s(),o(82,"div",19)(83,"mat-icon"),c(84),s(),o(85,"span"),c(86),s()(),o(87,"div",20),c(88),s()(),o(89,"div",21),A(90,"div",26),s()(),o(91,"div",27)(92,"div",16)(93,"mat-icon"),c(94,"attach_money"),s()(),o(95,"div",17)(96,"div",18),c(97),s(),o(98,"div",19)(99,"mat-icon"),c(100),s(),o(101,"span"),c(102),s()(),o(103,"div",20),c(104),s()(),o(105,"div",21),A(106,"div",28),s()()(),o(107,"div",29)(108,"div",30)(109,"mat-form-field",31)(110,"mat-label"),c(111),s(),o(112,"input",32),re("ngModelChange",function(l){return ie(n.searchTerm,l)||(n.searchTerm=l),l}),x("input",function(){return n.applyFilters()}),s(),o(113,"mat-icon",33),c(114,"search"),s()(),o(115,"mat-form-field",31)(116,"mat-label"),c(117),s(),o(118,"mat-select",34),re("ngModelChange",function(l){return ie(n.selectedStatus,l)||(n.selectedStatus=l),l}),x("selectionChange",function(){return n.applyFilters()}),o(119,"mat-option",35),c(120),s(),o(121,"mat-option",36),c(122),s(),o(123,"mat-option",37),c(124),s()()(),o(125,"mat-form-field",31)(126,"mat-label"),c(127),s(),o(128,"mat-select",34),re("ngModelChange",function(l){return ie(n.selectedCity,l)||(n.selectedCity=l),l}),x("selectionChange",function(){return n.applyFilters()}),o(129,"mat-option",35),c(130),s(),P(131,ri,2,2,"mat-option",38),s()()()(),o(132,"mat-card",39)(133,"mat-card-header",40)(134,"mat-icon",41),c(135,"local_shipping"),s(),o(136,"mat-card-title"),c(137),s(),o(138,"div",42),c(139),s()(),o(140,"mat-card-content"),P(141,oi,4,1,"div",43)(142,Ei,3,2,"div",44),o(143,"mat-paginator",45),x("page",function(l){return n.onPageChange(l)}),s()()()(),o(144,"div",46)(145,"h3",47),c(146),s(),o(147,"div",48)(148,"button",49),x("click",function(){return n.navigateToCompletedOrders()}),o(149,"mat-icon"),c(150,"check_circle"),s(),o(151,"span"),c(152),s()(),o(153,"button",50),x("click",function(){return n.navigateToCancelledOrders()}),o(154,"mat-icon"),c(155,"cancel"),s(),o(156,"span"),c(157),s()(),o(158,"button",51),x("click",function(){return n.navigateToOverview()}),o(159,"mat-icon"),c(160,"dashboard"),s(),o(161,"span"),c(162),s()(),o(163,"button",52),x("click",function(){return n.navigateToRestaurants()}),o(164,"mat-icon"),c(165,"restaurant"),s(),o(166,"span"),c(167),s()()()(),o(168,"div",53)(169,"h3",47),c(170),s(),o(171,"div",54),P(172,ki,12,8,"div",55),s()()),t&2&&(N("rtl",n.translationService.isRTL()),a(5),g(n.translationService.translate("currentDeliveries")),a(2),g(n.translationService.translate("currentDeliveriesSubtitle")||"Track and manage active delivery orders in real-time"),a(6),g(kt(14,100,n.currentDate,"EEEE, MMMM d, yyyy")),a(2),C("innerHTML",n.liveTime,we),a(2),C("disabled",n.isLoading),a(),N("spinning",n.isLoading),a(5),f(" ",n.translationService.translate("export")," "),a(3),N("active",n.selectedTimeFilter==="day"),a(3),f(" ",n.translationService.translate("today")," "),a(),N("active",n.selectedTimeFilter==="week"),a(3),f(" ",n.translationService.translate("week")," "),a(),N("active",n.selectedTimeFilter==="month"),a(3),f(" ",n.translationService.translate("month")," "),a(),N("active",n.selectedTimeFilter==="custom"),a(3),f(" ",n.translationService.translate("custom")," "),a(2),C("@slideInUp",void 0),a(6),g(n.currentDeliveries.length),a(),k(n.getTrendClass(n.getTrendPercentage(n.currentDeliveries.length,n.previousPeriodData.totalDeliveries))),a(2),g(n.getTrendIcon(n.getTrendPercentage(n.currentDeliveries.length,n.previousPeriodData.totalDeliveries))),a(2),f("",n.getTrendPercentage(n.currentDeliveries.length,n.previousPeriodData.totalDeliveries),"%"),a(2),g(n.translationService.translate("totalCurrentDeliveries")||"Total Current"),a(2),U("width",n.Math.min(n.currentDeliveries.length/50*100,100),"%"),a(),U("animation-delay","0.1s"),C("@slideInUp",void 0),a(6),g(n.getOnTimeDeliveriesCount()),a(),k(n.getTrendClass(n.getTrendPercentage(n.getOnTimeDeliveriesCount(),n.previousPeriodData.onTimeDeliveries))),a(2),g(n.getTrendIcon(n.getTrendPercentage(n.getOnTimeDeliveriesCount(),n.previousPeriodData.onTimeDeliveries))),a(2),f("",n.getTrendPercentage(n.getOnTimeDeliveriesCount(),n.previousPeriodData.onTimeDeliveries),"%"),a(2),g(n.translationService.translate("onTimeDeliveries")||"On-Time"),a(2),U("width",n.currentDeliveries.length>0?n.getOnTimeDeliveriesCount()/n.currentDeliveries.length*100:0,"%"),a(),U("animation-delay","0.2s"),C("@slideInUp",void 0),a(6),g(n.getDelayedDeliveriesCount()),a(),k(n.getTrendClass(n.getTrendPercentage(n.getDelayedDeliveriesCount(),n.previousPeriodData.delayedDeliveries))),a(2),g(n.getTrendIcon(n.getTrendPercentage(n.getDelayedDeliveriesCount(),n.previousPeriodData.delayedDeliveries))),a(2),f("",n.getTrendPercentage(n.getDelayedDeliveriesCount(),n.previousPeriodData.delayedDeliveries),"%"),a(2),g(n.translationService.translate("delayedDeliveries")||"Delayed"),a(2),U("width",n.currentDeliveries.length>0?n.getDelayedDeliveriesCount()/n.currentDeliveries.length*100:0,"%"),a(),U("animation-delay","0.3s"),C("@slideInUp",void 0),a(6),g(n.formatCurrency(n.getTotalValue())),a(),k(n.getTrendClass(n.getTrendPercentage(n.getTotalValue(),n.previousPeriodData.totalValue))),a(2),g(n.getTrendIcon(n.getTrendPercentage(n.getTotalValue(),n.previousPeriodData.totalValue))),a(2),f("",n.getTrendPercentage(n.getTotalValue(),n.previousPeriodData.totalValue),"%"),a(2),g(n.translationService.translate("totalValue")||"Total Value"),a(2),U("width",n.Math.min(n.getTotalValue()/1e5*100,100),"%"),a(5),g(n.translationService.translate("search")),a(),C("placeholder",Pe(n.translationService.translate("searchPlaceholder")||"Search orders...")),ne("ngModel",n.searchTerm),a(5),g(n.translationService.translate("status")),a(),ne("ngModel",n.selectedStatus),a(2),g(n.translationService.translate("allStatuses")||"All Statuses"),a(2),g(n.translationService.translate("active")||"Active"),a(2),g(n.translationService.translate("normal")||"Normal"),a(3),g(n.translationService.translate("city")),a(),ne("ngModel",n.selectedCity),a(2),g(n.translationService.translate("allCities")||"All Cities"),a(),C("ngForOf",n.getUniqueCities()),a(6),g(n.translationService.translate("currentDeliveries")),a(2),g(n.filteredDeliveries.length),a(2),C("ngIf",n.isLoading),a(),C("ngIf",!n.isLoading),a(),C("length",n.totalItems)("pageIndex",n.pageIndex)("pageSize",n.pageSize)("pageSizeOptions",Tt(103,ii)),wt("dir",n.translationService.isRTL()?"rtl":"ltr")("aria-label",n.translationService.translate("pagination")),a(),U("animation-delay","1.4s"),C("@slideInUp",void 0),a(2),g(n.translationService.translate("dashboard.quickActions")||"\u0625\u062C\u0631\u0627\u0621\u0627\u062A \u0633\u0631\u064A\u0639\u0629"),a(6),g(n.translationService.translate("dashboard.viewCompletedOrders")||"\u0639\u0631\u0636 \u0627\u0644\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0645\u0643\u062A\u0645\u0644\u0629"),a(5),g(n.translationService.translate("dashboard.viewCancelledOrders")||"\u0639\u0631\u0636 \u0627\u0644\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0645\u0644\u063A\u064A\u0629"),a(5),g(n.translationService.translate("dashboard.viewOverview")||"\u0639\u0631\u0636 \u0644\u0648\u062D\u0629 \u0627\u0644\u062A\u062D\u0643\u0645"),a(5),g(n.translationService.translate("dashboard.manageRestaurants")||"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u0637\u0627\u0639\u0645"),a(),U("animation-delay","1.5s"),C("@slideInUp",void 0),a(2),g(n.translationService.translate("dashboard.recentActivity")||"\u0627\u0644\u0646\u0634\u0627\u0637 \u0627\u0644\u0623\u062E\u064A\u0631"),a(2),C("ngForOf",n.recentActivities))},dependencies:[oe,De,Ie,At,Re,ke,Oe,Ae,dn,Zt,tn,an,nn,en,sn,rn,on,ln,cn,Vt,zt,de,Fe,We,Be,Ue,je,me,ue,le,se,ae,Je,qe,he,ge,pe,$e,Ee,Te,Ht,Ve,ze,jt,Ft,$t,Ut,Bt],styles:['.current-deliveries-container[_ngcontent-%COMP%]{padding:20px;font-family:Cairo,sans-serif;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh}.page-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 8px 32px #0000001a}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 8px;color:#fff;font-size:32px;font-weight:700}.header-subtitle[_ngcontent-%COMP%]{color:#ffffffe6;font-size:16px;margin:0}.date-time-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px}.current-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#ffffffe6;font-size:14px}.live-time[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#fff;font-family:Courier New,monospace}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.refresh-btn[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3)}.refresh-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.export-btn[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3)}.export-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.time-filters-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;margin-bottom:24px;box-shadow:0 4px 20px #00000014}.time-filters[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}.filter-btn[_ngcontent-%COMP%]{border-radius:12px;padding:12px 20px;font-weight:500;display:flex;align-items:center;gap:8px;transition:all .3s ease;border:2px solid transparent}.filter-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.filter-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-color:#667eea}.stats-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;box-shadow:0 4px 20px #00000014;display:flex;align-items:center;gap:16px;transition:transform .3s ease,box-shadow .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 32px #0000001f}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff}.total-deliveries[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.on-time-deliveries[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe)}.delayed-deliveries[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140)}.total-value[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3)}.stat-content[_ngcontent-%COMP%]{flex:1}.stat-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#2c3e50;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#7f8c8d;font-weight:500}.stat-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px;font-weight:600;margin-bottom:4px}.stat-change.positive[_ngcontent-%COMP%]{color:#27ae60}.stat-change.negative[_ngcontent-%COMP%]{color:#e74c3c}.stat-change.neutral[_ngcontent-%COMP%]{color:#7f8c8d}.progress-bar[_ngcontent-%COMP%]{width:100%;height:4px;background:#ecf0f1;border-radius:2px;overflow:hidden;margin-top:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:2px;transition:width .3s ease}.progress-fill.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe)}.progress-fill.warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140)}.progress-fill.info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3)}.quick-actions-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 4px 20px #00000014}.section-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#2c3e50;margin:0 0 20px;text-align:center}.quick-actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.action-btn[_ngcontent-%COMP%]{border-radius:12px;padding:16px 20px;font-weight:500;display:flex;align-items:center;gap:12px;transition:all .3s ease;min-height:60px}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #00000026}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px!important;width:20px!important;height:20px!important;display:inline-block!important;vertical-align:middle!important;line-height:1!important;font-family:Material Icons!important;font-weight:400!important;font-style:normal!important;text-transform:none!important;letter-spacing:normal!important;word-wrap:normal!important;white-space:nowrap!important;direction:ltr!important;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important;-moz-osx-font-smoothing:grayscale!important;font-feature-settings:"liga"!important;opacity:1!important;visibility:visible!important}.recent-activity-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 4px 20px #00000014}.activity-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.activity-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#f8f9fa;border-radius:12px;transition:all .3s ease}.activity-item[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translate(4px)}.activity-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;flex-shrink:0}.activity-icon.delivery[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.activity-icon.order[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe)}.activity-icon.customer[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140)}.activity-icon.store[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3)}.activity-content[_ngcontent-%COMP%]{flex:1}.activity-title[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;margin-bottom:4px}.activity-time[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d}.activity-status[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px}.activity-status.active[_ngcontent-%COMP%]{background:#27ae60}.activity-status.completed[_ngcontent-%COMP%]{background:#3498db}.activity-status.pending[_ngcontent-%COMP%]{background:#f39c12}.filters-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:0 4px 20px #00000014}.filter-group[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;align-items:center}.filter-field[_ngcontent-%COMP%]{min-width:200px;flex:1}.data-card[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 4px 20px #00000014;overflow:hidden}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:16px}.deliveries-icon[_ngcontent-%COMP%]{background:#fff3;color:#fff}.count-badge[_ngcontent-%COMP%]{background:#fff3;color:#fff;padding:4px 12px;border-radius:20px;font-size:14px;font-weight:600;margin-left:auto}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.deliveries-table[_ngcontent-%COMP%]{width:100%;background:#fff;border-collapse:collapse}.sortable-header[_ngcontent-%COMP%]{background:#f8f9fa!important;font-weight:600;color:#495057;padding:16px 12px;text-align:left!important;border-bottom:2px solid #dee2e6;cursor:pointer;transition:all .3s ease;white-space:nowrap;display:table-cell!important;vertical-align:middle!important}.sortable-header[_ngcontent-%COMP%]:hover{background:#e9ecef}.sortable-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:8px;font-size:18px;opacity:.6;vertical-align:middle}.delivery-row[_ngcontent-%COMP%]:hover{background:#f8f9fa}.order-id-cell[_ngcontent-%COMP%]{display:flex;align-items:center}.order-id[_ngcontent-%COMP%]{font-weight:600;color:#667eea}.time-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.customer-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.customer-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;color:#fff}.customer-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.customer-name[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.customer-phone[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d}.store-cell[_ngcontent-%COMP%], .location-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.amount-cell[_ngcontent-%COMP%]{text-align:right}.amount-value[_ngcontent-%COMP%]{font-weight:600;color:#27ae60}.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.status-normal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea,#fed6e3);color:#2c3e50}.time-positive[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.time-negative[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140);color:#fff}.time-neutral[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffecd2,#fcb69f);color:#2c3e50}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.action-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px;transition:all .3s ease;cursor:pointer}.action-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 2px 8px #0003}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important;width:18px!important;height:18px!important;line-height:1!important}.view-btn[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.view-btn[_ngcontent-%COMP%]:hover{background:#bbdefb}.contact-btn[_ngcontent-%COMP%]{background:#e8f5e8;color:#388e3c}.contact-btn[_ngcontent-%COMP%]:hover{background:#c8e6c9}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#7f8c8d}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;color:#bdc3c7}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#2c3e50}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.rtl[_ngcontent-%COMP%]{direction:rtl}.rtl[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .customer-cell[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .store-cell[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .location-cell[_ngcontent-%COMP%], .rtl[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{flex-direction:row-reverse}@media (max-width: 768px){.current-deliveries-container[_ngcontent-%COMP%]{padding:12px}.header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.stats-section[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.filter-group[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filter-field[_ngcontent-%COMP%]{min-width:unset}.deliveries-table[_ngcontent-%COMP%]{font-size:14px}.customer-cell[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:4px}}@media (max-width: 480px){.page-header[_ngcontent-%COMP%]{padding:16px}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.stat-card[_ngcontent-%COMP%]{padding:16px}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;font-size:20px}.stat-value[_ngcontent-%COMP%]{font-size:24px}}'],data:{animation:[Gt]}})};export{xn as CurrentDeliveriesComponent};
