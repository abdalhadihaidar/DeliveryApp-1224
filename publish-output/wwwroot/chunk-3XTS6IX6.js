import{b as ie,f as re}from"./chunk-YG2AVUDB.js";import{D as je,E as ne,Wa as se,Xa as oe,n as _,o as ee,u as te,v as De,w as ke,y as Fe,z as D}from"./chunk-F6AVZLPP.js";import{Ib as T,J as E,Ja as X,Kc as Me,L as B,P as Q,R as Te,Uc as Le,a as l,aa as C,b as y,d as P,da as N,f as Se,g as Z,h as Y,ha as f,ia as M,ka as g,kb as Oe,la as h,ma as Re,n as O,o as b,r as Ie,s as U,sb as L,t as G,ub as Ne,w as Ee,wa as S,x as W,xa as Ae,y as p,z as J}from"./chunk-PBCT4LDD.js";var ae=ce;function ce(i,t){return i===t||i!==i&&t!==t?!0:typeof i!=typeof t||{}.toString.call(i)!={}.toString.call(t)||i!==Object(i)||!i?!1:Array.isArray(i)?$e(i,t):{}.toString.call(i)=="[object Set]"?$e(Array.from(i),Array.from(t)):{}.toString.call(i)=="[object Object]"?st(i,t):rt(i,t)}function rt(i,t){return i.toString()===t.toString()}function $e(i,t){var o=i.length;if(o!=t.length)return!1;for(var e=0;e<o;e++)if(!ce(i[e],t[e]))return!1;return!0}function st(i,t){var o=Object.keys(i),e=o.length;if(e!=Object.keys(t).length)return!1;for(var n=0;n<e;n++){var r=o[n];if(!(t.hasOwnProperty(r)&&ce(i[r],t[r])))return!1}return!0}var xe=k;function k(i){let t=i;var o={}.toString.call(i).slice(8,-1);if(o=="Set")return new Set([...i].map(n=>k(n)));if(o=="Map")return new Map([...i].map(n=>[k(n[0]),k(n[1])]));if(o=="Date")return new Date(i.getTime());if(o=="RegExp")return RegExp(i.source,ot(i));if(o=="Array"||o=="Object"){t=Array.isArray(i)?[]:{};for(var e in i)t[e]=k(i[e])}return t}function ot(i){if(typeof i.source.flags=="string")return i.source.flags;var t=[];return i.global&&t.push("g"),i.ignoreCase&&t.push("i"),i.multiline&&t.push("m"),i.sticky&&t.push("y"),i.unicode&&t.push("u"),t.join("")}var dt=(()=>{let t=class t{warningMessage(){console.error("You should add @abp/ng-oauth packages or create your own auth packages.")}init(){return this.warningMessage(),Promise.resolve(void 0)}login(e){return this.warningMessage(),U(void 0)}logout(e){return this.warningMessage(),U(void 0)}navigateToLogin(e){}get isInternalAuth(){throw new Error("not implemented")}get isAuthenticated(){return this.warningMessage(),!1}loginUsingGrant(e,n,r){return console.log({grantType:e,parameters:n,headers:r}),Promise.reject(new Error("not implemented"))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),ue=class{},de=class extends ue{warningMessage(){console.error("You should add @abp/ng-oauth packages or create your own auth packages.")}get(t){throw this.warningMessage(),new Error("not implemented")}add(t){this.warningMessage()}patch(t){this.warningMessage()}remove(t){this.warningMessage()}run(t){throw this.warningMessage(),new Error("not implemented")}},ze=new g("LOCALIZATIONS");function Pe(i){i&&le.next([...le.value,...i])}var le=new b([]),$=new g("CORE_OPTIONS");function lt(t){var i=P(t,[]);return l({},i)}function he(i){return(t,o,e)=>{if(t==="_")return o;let n=i?.values?.[t];return n&&n[o]||e}}function Ue(i){let t=ht(i);return(o,e,n)=>{let{localized:r}=t(o,e);return r||n}}function ht(i){let t=he(i);return(o,e)=>{o=o.concat(i.defaultResourceName||"").filter(Boolean);let n=o.length,r=e.length;for(let s=0;s<n;s++){let a=o[s];for(let c=0;c<r;c++){let u=e[c],d=t(a,u,null);if(d)return{resourceName:a,key:u,localized:d}}}return{resourceName:void 0,key:void 0,localized:void 0}}}function pt(i){return t=>{let o=[],e=i.replace(/\./g,"\\.").replace(/\{\s?([0-9a-zA-Z]+)\s?\}/g,(r,s)=>(o.push(s),"(.+)"));return(t.match(e)||[]).slice(1).reduce((r,s,a)=>{let c=o[a];return r[c]=[...r[c]||[],s].filter(Boolean),r},{})}}function ft(i,t){return i.replace(/(['"]?\{\s*(\d+)\s*\}['"]?)/g,(o,e,n)=>t[n]??e).replace(/\s+/g," ")}var gt=new De(()=>!1),mt=(()=>{var t,pe;let e=class e extends D{constructor(){super(...arguments);Se(this,t)}request(s,a,c={}){return typeof s=="string"?(Z(this,t,pe).call(this,c),super.request(s,a||"",c)):(Z(this,t,pe).call(this,s),super.request(s))}};t=new WeakSet,pe=function(s){s.context??=new ke,s.context.set(gt,!0)},e.\u0275fac=(()=>{let s;return function(c){return(s||(s=X(e)))(c||e)}})(),e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function fe(){return function(){}}function vt(i){return i===void 0||i===""}function F(i){return i==null}function Ye(i){return!F(i)}function ge(i){return i instanceof Object}function q(i){return Array.isArray(i)}function yt(i){return ge(i)&&!q(i)}function me(i){return i instanceof Node}function Ge(i){return yt(i)&&!me(i)}function bt(i,t){return Object.prototype.hasOwnProperty.call(i,t)}function We(i,t){return Ge(i)&&Ge(t)?Je(i,t):F(i)&&F(t)?{}:Ye(t)?t:i}function Je(i,t){if(F(i)||F(t)||q(i)||q(t)||!ge(i)||!ge(t)||me(i)||me(t))return Ye(t)?t:i;let e=Object.keys(i),n=Object.keys(t);return[...new Set(e.concat(n))].reduce((s,a)=>(s[a]=Je(i[a],t[a]),s),{})}var j=class{get state(){return this.state$.value}constructor(t){this.initialState=t,this.state$=new b(this.initialState),this.update$=new O,this.sliceState=(o,e=ae)=>this.state$.pipe(p(o),Te(e)),this.sliceUpdate=(o,e=n=>n!==void 0)=>this.update$.pipe(p(o),E(e))}patch(t){let o=t;typeof t=="object"&&!Array.isArray(t)&&(o=l(l({},this.state),t)),this.state$.next(o),this.update$.next(o)}deepPatch(t){this.state$.next(We(this.state,t)),this.update$.next(t)}set(t){this.state$.next(t),this.update$.next(t)}reset(){this.set(this.initialState)}},Be=i=>t=>(i&&t[i]||t.default).url||t.default.url,qe=i=>i&&(i.endsWith("/")?i:i+"/"),x=(()=>{let t=class t{constructor(){this.store=new j({})}get createOnUpdateStream(){return this.store.sliceUpdate}getEnvironment$(){return this.store.sliceState(e=>e)}getEnvironment(){return this.store.state}getApiUrl(e){return Be(e)(this.store.state?.apis)}getApiUrl$(e){return this.store.sliceState(n=>n.apis).pipe(p(Be(e)))}setState(e){this.store.set(e)}getIssuer(){let e=this.store.state?.oAuthConfig?.issuer;return qe(e)}getIssuer$(){return this.store.sliceState(e=>e?.oAuthConfig?.issuer).pipe(p(qe))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Qe=(()=>{let t=class t{constructor(){this._reporter$=new O,this._errors$=new b([])}get reporter$(){return this._reporter$.asObservable()}get errors$(){return this._errors$.asObservable()}get errors(){return this._errors$.value}reportError(e){this._reporter$.next(e),this._errors$.next([...this.errors,e])}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),K=(()=>{let t=class t{constructor(e,n,r,s,a){this.options=e,this.http=n,this.externalHttp=r,this.environment=s,this.httpErrorReporter=a}getApiFromStore(e){return this.environment.getApiUrl(e)}handleError(e){return this.httpErrorReporter.reportError(e),G(e)}request(e,n,r){n=n||{},r=r||this.getApiFromStore(n.apiName);let w=e,{method:s,params:a}=w,c=P(w,["method","params"]),{observe:u="body",skipHandleError:d}=n,m=this.removeDuplicateSlashes(r+e.url);return this.getHttpClient(n.skipAddingHeader).request(s,m,l(l({observe:u},a&&{params:this.getParams(a,n.httpParamEncoder)}),c)).pipe(B(I=>d?G(I):this.handleError(I)))}getHttpClient(e){return e?this.externalHttp:this.http}getParams(e,n){let r=Object.entries(e).reduce((s,[a,c])=>(vt(c)||c===null&&!this.options.sendNullsAsQueryParam||(s[a]=c),s),{});return n?new te({encoder:n,fromObject:r}):new te({fromObject:r})}removeDuplicateSlashes(e){return e.replace(/([^:]\/)\/+/g,"$1")}};t.\u0275fac=function(n){return new(n||t)(h($),h(D),h(mt),h(x),h(Qe))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),wt=(()=>{let t=class t{constructor(e){this.restService=e,this.apiName="abp",this.get=n=>this.restService.request({method:"GET",url:"/api/abp/application-configuration",params:{includeLocalizationResources:n.includeLocalizationResources}},{apiName:this.apiName})}};t.\u0275fac=function(n){return new(n||t)(h(K))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Ct=(()=>{let t=class t{constructor(e){this.restService=e,this.apiName="abp",this.get=n=>this.restService.request({method:"GET",url:"/api/abp/application-localization",params:{cultureName:n.cultureName,onlyDynamics:n.onlyDynamics}},{apiName:this.apiName})}};t.\u0275fac=function(n){return new(n||t)(h(K))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Xe=new g("INCUDE_LOCALIZATION_RESOURCES_TOKEN"),A=(()=>{let t=class t{setState(e){this.store.set(e)}get createOnUpdateStream(){return this.store.sliceUpdate}constructor(e,n,r){this.abpConfigService=e,this.abpApplicationLocalizationService=n,this.includeLocalizationResources=r,this.updateSubject=new O,this.store=new j({}),this.initUpdateStream()}initUpdateStream(){this.updateSubject.pipe(C(()=>this.abpConfigService.get({includeLocalizationResources:!!this.includeLocalizationResources}))).pipe(C(e=>this.getLocalizationAndCombineWithAppState(e))).subscribe(e=>this.store.set(e))}getLocalizationAndCombineWithAppState(e){if(!e.localization.currentCulture.cultureName)throw new Error("culture name should defined");return this.getlocalizationResource(e.localization.currentCulture.cultureName).pipe(p(n=>y(l({},e),{localization:l(l({},e.localization),n)})))}getlocalizationResource(e){return this.abpApplicationLocalizationService.get({cultureName:e,onlyDynamics:!1})}refreshAppState(){return this.updateSubject.next(),this.createOnUpdateStream(e=>e).pipe(Q(1))}refreshLocalization(e){return this.includeLocalizationResources?this.refreshAppState().pipe(p(()=>null)):this.getlocalizationResource(e).pipe(N(n=>this.store.patch({localization:l(l({},this.store.state.localization),n)}))).pipe(p(()=>null))}getOne$(e){return this.store.sliceState(n=>n[e])}getOne(e){return this.store.state[e]}getAll$(){return this.store.sliceState(e=>e)}getAll(){return this.store.state}getDeep$(e){return e=Ve(e),this.store.sliceState(n=>n).pipe(p(n=>e.reduce((r,s)=>{if(r)return r[s]},n)))}getDeep(e){return e=Ve(e),e.reduce((n,r)=>{if(n)return n[r]},this.store.state)}getFeature(e){return this.store.state.features?.values?.[e]}getFeature$(e){return this.store.sliceState(n=>n.features?.values?.[e])}getFeatures(e){let{features:n}=this.store.state;if(n)return e.reduce((r,s)=>y(l({},r),{[s]:n.values[s]}),{})}getFeatures$(e){return this.store.sliceState(({features:n})=>{if(n?.values)return e.reduce((r,s)=>y(l({},r),{[s]:n.values[s]}),{})})}getSetting(e){return this.store.state.setting?.values?.[e]}getSetting$(e){return this.store.sliceState(n=>n.setting?.values?.[e])}getSettings(e){let n=this.store.state.setting?.values||{};return e?Object.keys(n).filter(s=>s.indexOf(e)>-1).reduce((s,a)=>(s[a]=n[a],s),{}):n}getSettings$(e){return this.store.sliceState(n=>n.setting?.values).pipe(p((n={})=>e?Object.keys(n).filter(s=>s.indexOf(e)>-1).reduce((s,a)=>(s[a]=n[a],s),{}):n))}getGlobalFeatures(){return this.store.state.globalFeatures}getGlobalFeatures$(){return this.store.sliceState(e=>e.globalFeatures)}isGlobalFeatureEnabled(e,n){return(n.enabledFeatures||[]).some(s=>e===s)}getGlobalFeatureIsEnabled(e){return this.isGlobalFeatureEnabled(e,this.store.state.globalFeatures)}getGlobalFeatureIsEnabled$(e){return this.store.sliceState(n=>this.isGlobalFeatureEnabled(e,n.globalFeatures))}};t.\u0275fac=function(n){return new(n||t)(h(wt),h(Ct),h(Xe,8))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function Ve(i){if(typeof i=="string"&&(i=i.split(".")),!Array.isArray(i))throw new Error("The argument must be a dot string or an string array.");return i}var St=(()=>{let t=class t{constructor(){}get length(){return localStorage.length}clear(){localStorage.clear()}getItem(e){return localStorage.getItem(e)}key(e){return localStorage.key(e)}removeItem(e){localStorage.removeItem(e)}setItem(e,n){localStorage.setItem(e,n)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),z=(()=>{let t=class t{constructor(e,n){this.configState=e,this.localStorageService=n,this.store=new j({}),this.updateLocalStorage=()=>{this.localStorageService.setItem("abpSession",JSON.stringify(this.store.state))},this.init(),this.setInitialLanguage()}init(){let e=this.localStorageService.getItem("abpSession");e&&this.store.set(JSON.parse(e)),this.store.sliceUpdate(n=>n).subscribe(this.updateLocalStorage)}setInitialLanguage(){let e=this.getLanguage();this.configState.getDeep$("localization.currentCulture.cultureName").pipe(E(n=>!!n),Q(1)).subscribe(n=>{n.includes(";")&&(n=n.split(";")[0]),e!==n&&this.setLanguage(n)})}onLanguageChange$(){return this.store.sliceUpdate(e=>e.language)}onTenantChange$(){return this.store.sliceUpdate(e=>e.tenant)}getLanguage(){return this.store.state.language}getLanguage$(){return this.store.sliceState(e=>e.language)}getTenant(){return this.store.state.tenant}getTenant$(){return this.store.sliceState(e=>e.tenant)}setTenant(e){ae(e,this.store.state.tenant)||this.store.set(y(l({},this.store.state),{tenant:e}))}setLanguage(e){e!==this.store.state.language&&(this.store.patch({language:e}),document.documentElement.setAttribute("lang",e))}};t.\u0275fac=function(n){return new(n||t)(h(A),h(St))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),R=(()=>{let t=class t{get currentLang(){return this.latestLang||this.sessionState.getLanguage()}get currentLang$(){return this.sessionState.getLanguage$()}get languageChange$(){return this._languageChange$.asObservable()}constructor(e,n,r,s){if(this.sessionState=e,this.injector=n,this.configState=s,this.latestLang=this.sessionState.getLanguage(),this._languageChange$=new O,this.uiLocalizations$=new b(new Map),this.localizations$=new b(new Map),r)throw new Error("LocalizationService should have only one instance.");this.listenToSetLanguage(),this.initLocalizationValues()}initLocalizationValues(){le.subscribe(a=>this.addLocalization(a));let e=this.configState.getDeep$("localization.values"),n=this.configState.getDeep$("localization.resources"),r=this.sessionState.getLanguage$(),s=J([r,this.uiLocalizations$]).pipe(p(([a,c])=>c.get(a)));J([e,n,s]).pipe(p(([a,c,u])=>{if(!c)return;let d=Et(a||{},c);return d&&(u||(u=new Map),Object.entries(d).forEach(m=>{let v=m[0],w=m[1],I=u?.get(v)||{};I=l(l({},I),w),u?.set(v,I)})),u}),E(Boolean)).subscribe(a=>this.localizations$.next(a))}addLocalization(e){if(!e)return;let n=this.uiLocalizations$.value;e.forEach(r=>{let s=n.get(r.culture)||new Map;r.resources.forEach(a=>{let c=s.get(a.resourceName)||{};c=l(l({},c),a.texts),s.set(a.resourceName,c)}),n.set(r.culture,s)}),this.uiLocalizations$.next(n)}listenToSetLanguage(){this.sessionState.onLanguageChange$().pipe(E(e=>this.configState.getDeep("localization.currentCulture.cultureName")!==e),C(e=>this.configState.refreshAppState().pipe(p(()=>e))),E(Boolean),C(e=>Ie(this.registerLocale(e).then(()=>e)))).subscribe(e=>this._languageChange$.next(e))}registerLocale(e){let{registerLocaleFn:n}=this.injector.get($);return n(e).then(r=>{r?.default&&ee(r.default),this.latestLang=e})}get(e,...n){return this.configState.getAll$().pipe(p(r=>this.getLocalization(r,e,...n)))}getResource(e){return this.localizations$.value.get(e)}getResource$(e){return this.localizations$.pipe(p(n=>n.get(e)))}instant(e,...n){return this.getLocalization(this.configState.getAll(),e,...n)}localize(e,n,r){return this.configState.getOne$("localization").pipe(p(he),p(s=>s(e,n,r)))}localizeSync(e,n,r){let s=this.configState.getOne("localization");return he(s)(e,n,r)}localizeWithFallback(e,n,r){return this.configState.getOne$("localization").pipe(p(Ue),p(s=>s(e,n,r)))}localizeWithFallbackSync(e,n,r){let s=this.configState.getOne("localization");return Ue(s)(e,n,r)}getLocalization(e,n,...r){n||(n="");let s="";typeof n!="string"&&(s=n.defaultValue,n=n.key);let a=n.split("::"),c=w=>{Le()&&console.warn(w)};if(a.length<2)return c("The localization source separator (::) not found."),s||n;if(!e.localization)return s||a[1];let u=a[0]||e.localization.defaultResourceName,d=a[1];if(u==="_")return s||d;if(!u)return c("Localization source name is not specified and the defaultResourceName was not defined!"),s||d;let m=this.localizations$.value.get(u);if(!m)return c("Could not find localization source: "+u),s||d;let v=m[d];return typeof v>"u"?s||d:(r=r.filter(w=>w!=null),v&&(v=ft(v,r)),typeof v!="string"&&(v=""),v||s||n)}};t.\u0275fac=function(n){return new(n||t)(h(z),h(S),h(t,12),h(A))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function _e(i,t){let o=t[i];return o.baseResources.length===0?o:o.baseResources.reduce((e,n)=>{let r=_e(n,t),s=l(l({},r.texts),o.texts);return y(l({},e),{texts:s})},o)}function It(i){return Object.keys(i).map(o=>{let e=_e(o,i);return[o,e]}).reduce((o,[e,n])=>y(l({},o),{[e]:n}),{})}function Et(i,t){let o=It(t);return Object.entries(o).reduce((e,[n,r])=>y(l({},e),{[n]:r.texts}),i)}var Tt=new g("APP_INIT_ERROR_HANDLERS"),Rt=new g("COOKIE_LANGUAGE_KEY",{factory:()=>".AspNetCore.Culture"}),Ci=new g("LIST_QUERY_DEBOUNCE_TIME"),Si=new g("LOADER_DELAY"),Ii=new g("NAVIGATE_TO_MANAGE_PROFILE"),At=new g("QUEUE_MANAGER"),et=new g("TENANT_KEY"),Ei=new g("PIPE_TO_LOGIN_FN_KEY"),Ti=new g("SET_TOKEN_RESPONSE_TO_STORAGE_FN_KEY"),Ot=new g("CHECK_AUTHENTICATION_STATE_FN_KEY"),tt=new g("OTHERS_GROUP"),Nt=new g("TENANT_NOT_FOUND_BY_NAME");function Mt(i){return t=>(i.push(t),i)}function Lt(i,t){let o=i.get(x),{remoteEnv:e}=t,{headers:n={},method:r="GET",url:s}=e||{};if(!s)return Promise.resolve();let a=i.get(D),c=i.get(Qe);return a.request(r,s,{headers:n}).pipe(B(u=>(c.reportError(u),U(null))),N(u=>o.setState(Dt(t,u||{},e)))).toPromise()}function Dt(i,t,o){switch(o.mergeStrategy){case"deepmerge":return We(i,t);case"overwrite":case null:case void 0:return t;default:return o.mergeStrategy(i,t)}}var kt=(()=>{let t=class t{constructor(e){this.restService=e,this.apiName="abp",this.findTenantById=n=>this.restService.request({method:"GET",url:`/api/abp/multi-tenancy/tenants/by-id/${n}`},{apiName:this.apiName}),this.findTenantByName=n=>this.restService.request({method:"GET",url:`/api/abp/multi-tenancy/tenants/by-name/${n}`},{apiName:this.apiName})}};t.\u0275fac=function(n){return new(n||t)(h(K))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Ft=(()=>{let t=class t{constructor(e,n,r,s,a){this.restService=e,this.sessionState=n,this.tenantService=r,this.configStateService=s,this.tenantKey=a,this.domainTenant=null,this.isTenantBoxVisible=!0,this.apiName="abp",this.setTenantToState=c=>(this.sessionState.setTenant({id:c.tenantId,name:c.name,isAvailable:!0}),this.configStateService.refreshAppState().pipe(p(u=>c)))}setTenantByName(e){return this.tenantService.findTenantByName(e).pipe(C(this.setTenantToState))}setTenantById(e){return this.tenantService.findTenantById(e).pipe(C(this.setTenantToState))}};t.\u0275fac=function(n){return new(n||t)(h(K),h(z),h(kt),h(A),h(et))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Ce="{0}";function jt(i){i.charAt(i.length-1)!=="/"&&(i+="/");let t=pt(i),o=Ce.replace(/[}{]/g,"");return t(window.location.href)[o]?.[0]}function $t(i){return new URLSearchParams(window.location.search).get(i)}function xt(i){return Y(this,null,function*(){let t=i.get(x),o=i.get(Ft),e=i.get(Nt,null),n=t.getEnvironment()?.application?.baseUrl||"",r=jt(n),s=()=>{o.isTenantBoxVisible=!1},a=d=>{o.domainTenant={id:d.tenantId,name:d.name,isAvailable:!0}},c=d=>{s(),a(d)};if(r){He(i,r);let d=o.setTenantByName(r);try{let m=yield W(d);return c(m),Promise.resolve(m)}catch(m){return m instanceof Fe&&m.status===404&&e&&e(m),Promise.reject()}}He(i,"",Ce+".");let u=$t(o.tenantKey);if(u){let d=o.setTenantById(u);return W(d)}return Promise.resolve()})}function He(i,t,o=Ce){let e=i.get(x),n=xe(e.getEnvironment());return n.application.baseUrl&&(n.application.baseUrl=n.application.baseUrl.replace(o,t)),n.oAuthConfig?.redirectUri&&(n.oAuthConfig.redirectUri=n.oAuthConfig.redirectUri.replace(o,t)),n.oAuthConfig||(n.oAuthConfig={}),n.oAuthConfig.issuer=(n.oAuthConfig.issuer||"").replace(o,t),Object.keys(n.apis).forEach(r=>{Object.keys(n.apis[r]).forEach(s=>{n.apis[r][s]=(n.apis[r][s]||"").replace(o,t)})}),e.setState(n)}function zt(i){return()=>Y(null,null,function*(){let o=i.get(x),e=i.get(A),n=i.get($);o.setState(n.environment),yield Lt(i,n.environment),yield xt(i);let r=i.get(dt,void 0,{optional:!0}),s=i.get(Ot,fe,{optional:!0});if(r&&(yield r.init()),n.skipGetAppConfiguration)return;let a=e.refreshAppState().pipe(N(()=>s(i)),N(()=>{let c=e.getOne("currentTenant");i.get(z).setTenant(c)}),B(c=>{let u=i.get(Tt,null);return u&&u.length&&u.forEach(d=>d(c)),G(c)}));yield Ee(a)})}function Pt(i){return()=>{let o=i.get(z),{registerLocaleFn:e}=i.get($),n=o.getLanguage()||"en";return new Promise((r,s)=>{e(n).then(a=>(a?.default&&ee(a.default),r("resolved")),s)})}}var ve=class{constructor(){this.queue=[],this.isRunning=!1,this.stack=0,this.interval=0,this.stackSize=100}init(t,o){this.interval=t,this.stackSize=o}add(t){this.queue.push(t),this.run()}run(){if(this.isRunning)return;this.stack++,this.isRunning=!0;let t=this.queue.shift();if(!t){this.isRunning=!1;return}t(),this.stack>this.stackSize?setTimeout(()=>{this.isRunning=!1,this.run(),this.stack=0},this.interval):(this.isRunning=!1,this.run())}},ye=class i{constructor(t){this.children=[],this.isLeaf=!0,Object.assign(this,t)}static create(t){return new i(t)}};function Ut(i,t,o,e){let n=Gt(i,t,e),r=[];return i.forEach(s=>{let a=t(s),c=o(s),u=n.get(a);if(u)if(c){let d=n.get(c);if(!d)return;d.children.push(u),d.isLeaf=!1,u.parent=d}else r.push(u)}),r}function Gt(i,t,o){let e=new Map;return i.forEach(n=>e.set(t(n),o(n))),e}function Bt(i,t){if(!q(i)||!i.some(e=>!!e.group))return;let o=new Map;for(let e of i){let n=e?.group||t;if(typeof n!="string")throw new Error(`Invalid group: ${n}`);let r=o.get(n)||[];r.push(e),o.set(n,r)}return o}var qt=(()=>{let t=class t{constructor(e){this.configState=e}getGrantedPolicy$(e){return this.getStream().pipe(p(n=>this.isPolicyGranted(e,n)))}getGrantedPolicy(e){let n=this.getSnapshot();return this.isPolicyGranted(e,n)}filterItemsByPolicy(e){let n=this.getSnapshot();return e.filter(r=>!r.requiredPolicy||this.isPolicyGranted(r.requiredPolicy,n))}filterItemsByPolicy$(e){return this.getStream().pipe(p(n=>e.filter(r=>!r.requiredPolicy||this.isPolicyGranted(r.requiredPolicy,n))))}isPolicyGranted(e,n){if(!e)return!0;let r=/\|\|/g,s=/&&/g;if(r.test(e)){let a=e.split("||").filter(Boolean);return a.length<2?!1:a.some(c=>this.getPolicy(c.trim(),n))}else if(s.test(e)){let a=e.split("&&").filter(Boolean);return a.length<2?!1:a.every(c=>this.getPolicy(c.trim(),n))}return this.getPolicy(e,n)}getStream(){return this.configState.getAll$().pipe(p(this.mapToPolicies))}getSnapshot(){return this.mapToPolicies(this.configState.getAll())}mapToPolicies(e){return e?.auth?.grantedPolicies||{}}getPolicy(e,n){return n[e]||!1}};t.\u0275fac=function(n){return new(n||t)(h(A))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var nt=new g("SORT_COMPARE_FUNC");function Vt(){let i=Re(R);return(o,e)=>{let n=i.instant(o.name),r=i.instant(e.name),s=o.order,a=e.order;return Number.isInteger(s)?Number.isInteger(a)?s>a?1:s<a?-1:n>r?1:n<r?-1:0:-1:1}}var be=class{constructor(){this._flat$=new b([]),this._tree$=new b([]),this._visible$=new b([])}get flat(){return this._flat$.value}get flat$(){return this._flat$.asObservable()}get tree(){return this._tree$.value}get tree$(){return this._tree$.asObservable()}get visible(){return this._visible$.value}get visible$(){return this._visible$.asObservable()}createTree(t){return Ut(t,o=>o[this.id],o=>o[this.parentId],o=>ye.create(o))}createGroupedTree(t){let o=Bt(t,this.othersGroup);if(o)return Array.from(o,([e,n])=>({group:e,items:n}))}filterWith(t){return this._flat$.value.filter(o=>!t.has(o[this.id]))}findItemsToRemove(t){return this._flat$.value.reduce((o,e)=>{if(!o.has(e[this.parentId]))return o;let n=new Set([e[this.id]]),r=this.findItemsToRemove(n);return new Set([...o,...r])},t)}publish(t,o){return this._flat$.next(t),this._tree$.next(this.createTree(t)),this._visible$.next(this.createTree(o)),t}add(t){let o=new Map;t.forEach(r=>o.set(r[this.id],r));let e=this.filterWith(o);o.forEach(Mt(e)),e.sort(this.sort);let n=e.filter(r=>!this.hide(r));return this.publish(e,n)}find(t,o=this.tree){return o.reduce((e,n)=>e||(t(n)?n:this.find(t,n.children)),null)}patch(t,o){let e=this._flat$.value,n=e.findIndex(s=>s[this.id]===t);if(n<0)return!1;e[n]=l(l({},e[n]),o),e.sort(this.sort);let r=e.filter(s=>!this.hide(s));return this.publish(e,r)}refresh(){return this.add([])}remove(t){let o=new Set;t.forEach(s=>o.add(s));let e=this.findItemsToRemove(o),n=this.filterWith(e),r=n.filter(s=>!this.hide(s));return this.publish(n,r)}search(t,o=this.tree){let e=Object.keys(t);return o.reduce((n,r)=>n||(e.every(s=>r[s]===t[s])?r:this.search(t,r.children)),null)}},Ht=(()=>{let t=class t extends be{constructor(e){super(),this.injector=e,this.id="name",this.parentId="parentName",this.hide=r=>r.invisible||!this.isGranted(r),this.sort=(r,s)=>this.compareFunc(r,s);let n=this.injector.get(A);this.subscription=n.createOnUpdateStream(r=>r).subscribe(()=>this.refresh()),this.permissionService=e.get(qt),this.othersGroup=e.get(tt),this.compareFunc=e.get(nt)}isGranted({requiredPolicy:e}){return this.permissionService.getGrantedPolicy(e)}hasChildren(e){return!!this.find(r=>r[this.id]===e)?.children?.length}hasInvisibleChild(e){return this.find(r=>r[this.id]===e)?.children?.some(r=>r.invisible)||!1}ngOnDestroy(){this.subscription.unsubscribe()}};t.\u0275fac=function(n){return new(n||t)(h(S))},t.\u0275prov=f({token:t,factory:t.\u0275fac});let i=t;return i})(),Kt=(()=>{let t=class t extends Ht{hasPathOrChild(e){return!!e.path||this.hasChildren(e.name)}get groupedVisible(){return this.createGroupedTree(this.visible.filter(e=>this.hasPathOrChild(e)))}get groupedVisible$(){return this.visible$.pipe(p(e=>e.filter(n=>this.hasPathOrChild(n))),p(e=>this.createGroupedTree(e)))}};t.\u0275fac=(()=>{let e;return function(r){return(e||(e=X(t)))(r||t)}})(),t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),Zt=new g("DYNAMIC_LAYOUTS");var Ke={aa:"en","aa-DJ":"en","aa-ER":"en","aa-ET":"en","af-ZA":"af","agq-CM":"agq","ak-GH":"ak","am-ET":"am","ar-001":"ar",arn:"en","arn-CL":"en","as-IN":"as","asa-TZ":"asa","ast-ES":"ast","az-Cyrl-AZ":"az-Cyrl","az-Latn-AZ":"az-Latn",ba:"ru","ba-RU":"ru","bas-CM":"bas","be-BY":"be","bem-ZM":"bem","bez-TZ":"bez","bg-BG":"bg",bin:"en","bin-NG":"en","bm-Latn":"bm","bm-Latn-ML":"bm","bn-BD":"bn","bo-CN":"bo","br-FR":"br","brx-IN":"brx","bs-Cyrl-BA":"bs-Cyrl","bs-Latn-BA":"bs-Latn",byn:"en","byn-ER":"en","ca-ES":"ca","ca-ES-valencia":"ca-ES-VALENCIA","ce-RU":"ce","cgg-UG":"cgg","chr-Cher":"chr","chr-Cher-US":"chr",co:"en","co-FR":"fr","cs-CZ":"cs","cu-RU":"cu","cy-GB":"cy","da-DK":"da","dav-KE":"dav","de-DE":"de","dje-NE":"dje","dsb-DE":"dsb","dua-CM":"dua",dv:"en","dv-MV":"en","dyo-SN":"dyo","dz-BT":"dz","ebu-KE":"ebu","ee-GH":"ee","el-GR":"el","en-029":"en","en-ID":"en","en-US":"en","eo-001":"en","es-ES":"es","et-EE":"et","eu-ES":"eu","ewo-CM":"ewo","fa-IR":"fa","ff-Latn-SN":"ff-Latn","ff-NG":"ff","fi-FI":"fi","fil-PH":"fil","fo-FO":"fo","fr-029":"fr","fr-FR":"fr","fur-IT":"fur","fy-NL":"fy","ga-IE":"ga","gd-GB":"gd","gl-ES":"gl",gn:"en","gn-PY":"en","gsw-CH":"gsw","gu-IN":"gu","guz-KE":"guz","gv-IM":"gv","ha-Latn":"ha","ha-Latn-GH":"ha-GH","ha-Latn-NE":"ha-NE","ha-Latn-NG":"ha","haw-US":"haw","he-IL":"he","hi-IN":"hi","hr-HR":"hr","hsb-DE":"hsb","hu-HU":"hu","hy-AM":"hy","ia-001":"ia","ia-FR":"ia",ibb:"en","ibb-NG":"en","id-ID":"id","ig-NG":"ig","ii-CN":"ii","is-IS":"is","it-IT":"it",iu:"en","iu-Cans":"en","iu-Cans-CA":"en","iu-Latn":"en","iu-Latn-CA":"en","ja-JP":"ja","jgo-CM":"jgo","jmc-TZ":"jmc","jv-Java":"jv","jv-Java-ID":"jv","jv-Latn":"jv","jv-Latn-ID":"jv","ka-GE":"ka","kab-DZ":"kab","kam-KE":"kam","kde-TZ":"kde","kea-CV":"kea","khq-ML":"khq","ki-KE":"ki","kk-KZ":"kk","kkj-CM":"kkj","kl-GL":"kl","kln-KE":"kln","km-KH":"km","kn-IN":"kn","ko-KR":"ko","kok-IN":"kok",kr:"en","kr-NG":"en","ks-Arab":"ks","ks-Arab-IN":"ks","ks-Deva":"ks","ks-Deva-IN":"ks","ksb-TZ":"ksb","ksf-CM":"ksf","ksh-DE":"ksh","ku-Arab":"ku","ku-Arab-IQ":"ku","ku-Arab-IR":"ku","kw-GB":"kw","ky-KG":"ky",la:"en","la-001":"en","lag-TZ":"lag","lb-LU":"lb","lg-UG":"lg","lkt-US":"lkt","ln-CD":"ln","lo-LA":"lo","lrc-IR":"lrc","lt-LT":"lt","lu-CD":"lu","luo-KE":"luo","luy-KE":"luy","lv-LV":"lv","mas-KE":"mas","mer-KE":"mer","mfe-MU":"mfe","mg-MG":"mg","mgh-MZ":"mgh","mgo-CM":"mgo","mi-NZ":"mi","mk-MK":"mk","ml-IN":"ml","mn-Cyrl":"mn","mn-MN":"mn","mn-Mong":"mn","mn-Mong-CN":"mn","mn-Mong-MN":"mn",mni:"en","mni-IN":"en",moh:"en","moh-CA":"en","mr-IN":"mr","ms-MY":"ms","mt-MT":"mt","mua-CM":"mua","my-MM":"my","mzn-IR":"mzn","naq-NA":"naq","nb-NO":"nb","nd-ZW":"nd","ne-NP":"ne","nl-NL":"nl","nmg-CM":"ngm","nn-NO":"nn","nnh-CM":"nnh",no:"en",nqo:"en","nqo-GN":"en",nr:"en","nr-ZA":"en",nso:"en","nso-ZA":"en","nus-SS":"nus","nyn-UG":"nyn",oc:"en","oc-FR":"fr","om-ET":"om","or-IN":"or","os-GE":"os","pa-Arab-PK":"pa-Arab","pa-IN":"pa",pap:"en","pap-029":"en","pl-PL":"pl","prg-001":"prg",prs:"en","prs-AF":"en","ps-AF":"ps","pt-BR":"pt",quc:"en","quc-Latn":"en","quc-Latn-GT":"en",quz:"en","quz-BO":"en","quz-EC":"en","quz-PE":"en","rm-CH":"rm","rn-BI":"rn","ro-RO":"ro","rof-TZ":"rof","ru-RU":"ru","rw-RW":"rw","rwk-TZ":"rwk",sa:"en","sa-IN":"en","sah-RU":"sah","saq-KE":"saq","sbp-TZ":"en","sd-Arab":"sd","sd-Arab-PK":"sd","sd-Deva":"sd","sd-Deva-IN":"sd","se-NO":"se","seh-MZ":"seh","ses-ML":"ses","sg-CF":"sg","shi-Latn-MA":"shi-Latn","shi-Tfng-MA":"shi-Tfng","si-LK":"si","sk-SK":"sk","sl-SI":"sl",sma:"en","sma-NO":"en","sma-SE":"en",smj:"en","smj-NO":"en","smj-SE":"en","smn-FI":"en",sms:"en","sms-FI":"en","sn-Latn":"sn","sn-Latn-ZW":"sn","so-SO":"so","sq-AL":"so","sr-Cyrl-RS":"sr-Cryl","sr-Latn-RS":"sr-Latn",ss:"en","ss-SZ":"en","ss-ZA":"en",ssy:"en","ssy-ER":"en",st:"en","st-LS":"en","st-ZA":"en","sv-SE":"sv","sw-TZ":"sw",syr:"en","syr-SY":"en","ta-IN":"ta","te-IN":"te","teo-UG":"teo","tg-Cyrl":"tg","tg-Cyrl-TJ":"tg","th-TH":"th","ti-ET":"ti",tig:"en","tig-ER":"en","tk-TM":"tk",tn:"en","tn-BW":"en","tn-ZA":"en","to-TO":"to","tr-TR":"tr",ts:"en","ts-ZA":"en","tt-RU":"tt","twq-NE":"twq","tzm-Arab":"tzm","tzm-Arab-MA":"tzm","tzm-Latn":"tzm","tzm-Latn-DZ":"tzm","tzm-Latn-MA":"tzm","tzm-Tfng":"tzm","tzm-Tfng-MA":"tzm","ug-CN":"ug","uk-UA":"uk","ur-PK":"ur","uz-Arab-AF":"uz-Arab","uz-Cyrl-UZ":"uz-Cyrl","uz-Latn-UZ":"uz-Latn","vai-Latn-LR":"vai-Latn","vai-Vaii-LR":"vai-Vaii",ve:"en","ve-ZA":"en","vi-VN":"vi","vo-001":"vo","vun-TZ":"vun","wae-CH":"wae",wal:"en","wal-ET":"en","wo-SN":"wo","xh-ZA":"xh","xog-UG":"xog","yav-CM":"yav","yi-001":"yi","yo-NG":"yo","zgh-Tfng":"zgh","zgh-Tfng-MA":"zgh","zh-CN":"zh","zh-HK":"zh","zh-MO":"zh","zh-SG":"zh","zh-TW":"zh","zu-ZA":"zu"},Yt=new Map([["application","Theme.ApplicationLayoutComponent"],["account","Theme.AccountLayoutComponent"],["empty","Theme.EmptyLayoutComponent"]]);var Wt=(()=>{let t=class t{constructor(e,n){this.routes=e,this.router=n,this.addRoutes()}addRoutes(){this.router?.config?.forEach(({path:e="",data:n})=>{let r=n?.routes;if(r)if(Array.isArray(r))this.routes.add(r);else{let s=it([l({path:e},r)],{path:""});this.routes.add(s)}})}};t.\u0275fac=function(n){return new(n||t)(h(Kt),h(ie,8))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function it(i,t){return i?i.reduce((o,e)=>{let s=y(l({},e),{parentName:t.name,path:(t.path+"/"+e.path).replace(/\/\//g,"/")}),{children:n}=s,r=P(s,["children"]);return o.push(r,...it(n,r)),o},[]):[]}var Jt=(()=>{let t=class t{constructor(e){this.localization=e}transform(e="",...n){let r=n.reduce((s,a)=>s?a?Array.isArray(a)?[...s,...a]:[...s,a]:s:a,[])||[];return this.localization.instant(e,...r)}};t.\u0275fac=function(n){return new(n||t)(Oe(R,16))},t.\u0275pipe=Ne({name:"abpLocalization",type:t,pure:!0,standalone:!1}),t.\u0275prov=f({token:t,factory:t.\u0275fac});let i=t;return i})(),V=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=L({type:t}),t.\u0275inj=M({});let i=t;return i})();var Ri=new g("INJECTOR_PIPE_DATA_TOKEN");function Qt(i){return()=>{let t=i.get(z),o=i.get(Ae),e=i.get(Rt);t.getLanguage$().subscribe(n=>{let r=encodeURIComponent(`c=${n}|uic=${n}`);o.cookie=`${e}=${r}`})}}var Xt={provide:T,useFactory:Qt,deps:[S],multi:!0},we=class extends String{constructor(t){super(),this.localizationService=t}toString(){let{currentLang:t}=this.localizationService;return bt(Ke,t)?Ke[t]:t}valueOf(){return this.toString()}},_t={provide:Me,useClass:we,deps:[R]};Date.prototype.toLocalISOString=function(){let i=this.getTimezoneOffset();return new Date(this.getTime()-i*6e4).toISOString()};var en={provide:Xe,useValue:!1};var H=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=L({type:t}),t.\u0275inj=M({providers:[Jt],imports:[_,ne,se,oe,re,V,_,ne,se,oe,re,V]});let i=t;return i})(),Ze=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=L({type:t}),t.\u0275inj=M({imports:[H,V,je.withOptions({cookieName:"XSRF-TOKEN",headerName:"RequestVerificationToken"}),H,V]});let i=t;return i})(),Ai=(()=>{let t=class t{static forRoot(e={}){return{ngModule:Ze,providers:[_t,Xt,{provide:"CORE_OPTIONS",useValue:e},{provide:$,useFactory:lt,deps:["CORE_OPTIONS"]},{provide:T,multi:!0,deps:[S],useFactory:zt},{provide:T,multi:!0,deps:[S],useFactory:Pt},{provide:T,multi:!0,deps:[R],useFactory:fe},{provide:T,multi:!0,deps:[Wt],useFactory:fe},{provide:et,useValue:e.tenantKey||"__tenant"},{provide:ze,multi:!0,useValue:Pe(e.localizations),deps:[R]},{provide:nt,useFactory:Vt},{provide:At,useClass:ve},{provide:tt,useValue:e.othersGroup||"AbpUi::OthersGroup"},de,en,{provide:Zt,useValue:e.dynamicLayouts||Yt}]}}static forChild(e={}){return{ngModule:Ze,providers:[{provide:ze,multi:!0,useValue:Pe(e.localizations),deps:[R]}]}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=L({type:t}),t.\u0275inj=M({imports:[H,H]});let i=t;return i})();export{K as a,Ai as b};
